(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: True
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [63.46874531554489, 34.35851659498499, 44.582499736758976], 'dev_rel_ign': [59.062657384406755, 34.35851659498499, 43.44422591678643], 'dev_evi': [57.14285714285714, 27.86985880908533, 37.46647410769548]}
1 {'dev_rel': [63.1609305902711, 26.65746977197111, 37.49144031043141], 'dev_rel_ign': [59.52682708169238, 26.65746977197111, 36.82421627795907], 'dev_evi': [56.54192459200901, 20.55964804583589, 30.154561824729893]}
2 {'dev_rel': [57.285726818141946, 52.99034326056966, 55.05437990051429], 'dev_rel_ign': [53.09248549798412, 52.99034326056966, 53.04136520526453], 'dev_evi': [51.16152778615821, 43.37528135870677, 46.947758921403064]}
3 {'dev_rel': [55.87787626466112, 50.645135113202954, 53.132981440490376], 'dev_rel_ign': [51.936018675572015, 50.645135113202954, 51.28245464039614], 'dev_evi': [49.46377353784761, 40.58215674237774, 44.58494913730119]}
4 {'dev_rel': [49.2828710431541, 63.296275257648304, 55.417406749555944], 'dev_rel_ign': [45.07321743186451, 63.296275257648304, 52.65258158011504], 'dev_evi': [44.09064703534525, 50.85942295887047, 47.233769627289355]}
5 {'dev_rel': [58.93506493506494, 55.238172522924614, 57.026766640137396], 'dev_rel_ign': [54.995730092992, 55.238172522924614, 55.116684700633165], 'dev_evi': [52.755052935514925, 44.86392469817884, 48.490545173062046]}
6 {'dev_rel': [58.492389466054604, 58.93857015337174, 58.714632174616014], 'dev_rel_ign': [54.61030378281787, 58.93857015337174, 56.691944341241474], 'dev_evi': [51.65367483296214, 47.45754041334152, 49.46678042017703]}
7 {'dev_rel': [61.75508720930233, 55.16513835916579, 58.27439886845826], 'dev_rel_ign': [57.55620520460106, 55.16513835916579, 56.33531189670736], 'dev_evi': [55.68181818181818, 44.36771025168815, 49.38503587290741]}
8 {'dev_rel': [59.88895431984521, 57.77002353323054, 58.81040892193309], 'dev_rel_ign': [55.71654123180409, 57.77002353323054, 56.72470401788444], 'dev_evi': [53.55998576005696, 46.17863720073665, 49.59617603428383]}
9 {'dev_rel': [61.41948788451624, 58.00535583867564, 59.66362004924669], 'dev_rel_ign': [57.33966740395281, 58.00535583867564, 57.670590684113535], 'dev_evi': [54.70676691729324, 46.52649887456518, 50.28612501036685]}
10 {'dev_rel': [60.801684062801506, 56.252535908463855, 58.438711852975885], 'dev_rel_ign': [56.37020398675173, 56.252535908463855, 56.311308477887465], 'dev_evi': [54.79316324002973, 45.26294250051156, 49.57418198117436]}
11 {'dev_rel': [61.77951388888889, 57.75379371906192, 59.698863398062315], 'dev_rel_ign': [57.54507756480082, 57.75379371906192, 57.64924673100551], 'dev_evi': [55.289872798434445, 46.25025578064252, 50.36768802228412]}
12 {'dev_rel': [59.89282769991756, 58.954799967540374, 59.420112051691], 'dev_rel_ign': [55.62750815794646, 58.954799967540374, 57.24284437616395], 'dev_evi': [53.44180947435232, 47.38080622058523, 50.229127687844034]}
13 {'dev_rel': [59.19065034186674, 60.415483242716874, 59.79679530942532], 'dev_rel_ign': [54.90247754796831, 60.415483242716874, 57.527200265075216], 'dev_evi': [52.53486827540404, 48.5573971761817, 50.46788600595491]}
14 {'dev_rel': [62.5669858561012, 57.79436825448349, 60.0860541635029], 'dev_rel_ign': [58.3602071158407, 57.79436825448349, 58.075909463012856], 'dev_evi': [56.0672514619883, 47.0841006752609, 51.184517851184516]}
15 {'dev_rel': [59.18762088974855, 59.59587762720117, 59.391047672961065], 'dev_rel_ign': [54.92656870945566, 59.59587762720117, 57.166034642119115], 'dev_evi': [52.97214673913043, 47.866789441375076, 50.29022895840052]}
16 {'dev_rel': [62.02316076294277, 59.10898320214234, 60.53101757593385], 'dev_rel_ign': [57.833033886893226, 59.10898320214234, 58.464047630487], 'dev_evi': [55.34323709117048, 47.263147125025576, 50.98504497544286]}
17 {'dev_rel': [63.87588359496925, 56.46352349265601, 59.94141971054445], 'dev_rel_ign': [59.69889383480245, 56.46352349265601, 58.03615269170458], 'dev_evi': [57.61593729588505, 45.12482095355024, 50.61105054793734]}
18 {'dev_rel': [62.79379157427938, 57.453542156942305, 60.00508517670989], 'dev_rel_ign': [58.694367803569946, 57.453542156942305, 58.067327016456126], 'dev_evi': [56.89644278764138, 46.06609371802742, 50.91166077738515]}
19 {'dev_rel': [61.38695796094008, 60.196380751440394, 60.78584012783217], 'dev_rel_ign': [57.19266049798839, 60.196380751440394, 58.65609141844025], 'dev_evi': [54.81706617731391, 48.90014323715981, 51.689828583788454]}
20 {'dev_rel': [63.5582489146165, 57.02345208147367, 60.11377732152787], 'dev_rel_ign': [59.32357389265667, 57.02345208147367, 58.15077686509736], 'dev_evi': [57.386766316603314, 45.56476365868631, 50.79700019960649]}
21 {'dev_rel': [64.94731003882418, 57.01533717438936, 60.72339138325915], 'dev_rel_ign': [60.87494834825119, 57.01533717438936, 58.88196283793914], 'dev_evi': [58.74011631706202, 45.98424391242071, 51.58532036383462]}
22 {'dev_rel': [64.2870019830539, 57.87551732532662, 60.91301191442115], 'dev_rel_ign': [60.14886334726528, 57.87551732532662, 58.99029612212592], 'dev_evi': [58.12267419479019, 46.34233681195007, 51.56828143678488]}
23 {'dev_rel': [65.18628635138903, 56.93418810354621, 60.78142597245084], 'dev_rel_ign': [61.0903426156902, 56.93418810354621, 58.93908726594754], 'dev_evi': [59.07489865089387, 45.47268262737876, 51.388929035987864]}
24 {'dev_rel': [65.10874595094863, 57.08837133814818, 60.83535108958837], 'dev_rel_ign': [60.90022810526838, 57.08837133814818, 58.93272490820264], 'dev_evi': [59.04755640334145, 45.92285655821568, 51.66470029639434]}
25 {'dev_rel': [65.09183953212099, 57.8024831615678, 61.230980830396284], 'dev_rel_ign': [60.992545633623465, 57.8024831615678, 59.35468222406604], 'dev_evi': [58.965291421087095, 46.060978105177, 51.720374518926995]}
26 {'dev_rel': [65.76031287829407, 57.30747382942465, 61.243604197380975], 'dev_rel_ign': [61.7417541756927, 57.30747382942465, 59.442031181490506], 'dev_evi': [59.747123360984745, 45.68753836709638, 51.77991651205937]}
27 {'dev_rel': [65.19090909090909, 58.191998701614864, 61.492946876473866], 'dev_rel_ign': [61.08344337729095, 58.191998701614864, 59.60267420933106], 'dev_evi': [59.30908378501927, 46.45999590750972, 52.10407045122057]}
28 {'dev_rel': [65.45404563364794, 57.96478130325408, 61.48218281976244], 'dev_rel_ign': [61.34522704670847, 57.96478130325408, 59.60711459060156], 'dev_evi': [59.2886152233722, 46.301411909146715, 51.99632331820532]}
29 {'dev_rel': [65.45738427626745, 57.83494278990505, 61.41053810693206], 'dev_rel_ign': [61.35429504587516, 57.83494278990505, 59.542660198602604], 'dev_evi': [59.36925098554533, 46.224677716390424, 51.9788311090658]}
saving model checkpoint into bert_lambda0.1_seed66/2025-03-07_13:14:12.342325/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-03-07_13:14:12.342325/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-03-07_13:14:12.342325/scores.csv ...
             precision     recall         F1
dev_rel      65.454046  57.964781  61.482183
dev_rel_ign  61.345227  57.964781  59.607115
dev_evi      59.288615  46.301412  51.996323
saving topk results into bert_lambda0.1_seed66/2025-03-07_13:14:12.342325/topk_results.json ...
经过时间：2小时 52分钟 44秒
