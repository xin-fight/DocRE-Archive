(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
Saving to ./feature_file/train_annotated_feature.pkl
Save  ./feature_file/train_annotated_feature.pkl  !!!
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Saving to ./feature_file/dev_feature.pkl
Save  ./feature_file/dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [48.685342766994935, 41.3211068733263, 44.701957685892374], 'dev_rel_ign': [44.97641988417427, 41.3211068733263, 43.07134914853242], 'dev_evi': [43.01296973727968, 33.08266830366278, 37.39987855304629]}59<00:00, 7308.75it/s]
1 {'dev_rel': [57.25917747722882, 33.66874949281831, 42.40380193162655], 'dev_rel_ign': [52.818403332086525, 33.66874949281831, 41.12355493997886], 'dev_evi': [51.11657648794884, 26.580724370779617, 34.97459024669337]}<00:00, 7292.78it/s]
2 {'dev_rel': [55.30408866536276, 48.186318266655846, 51.50043365134431], 'dev_rel_ign': [51.02061640026473, 48.186318266655846, 49.56298001300659], 'dev_evi': [49.15395462120241, 39.231634949866994, 43.635846372688476]}0:00, 7302.57it/s]
3 {'dev_rel': [61.508924865089256, 48.097054288728394, 53.98242178605582], 'dev_rel_ign': [57.41187270936747, 48.097054288728394, 52.343285768982284], 'dev_evi': [55.0609666519759, 38.346633926744424, 45.20837102707919]}0:00, 7324.06it/s]
4 {'dev_rel': [49.61437908496732, 61.600259677026706, 54.96144517250118], 'dev_rel_ign': [45.45390218251334, 61.600259677026706, 52.30945026594453], 'dev_evi': [45.16415261756877, 49.47309187640679, 47.22052684260638]}<00:00, 7350.01it/s]
5 {'dev_rel': [54.42351168048229, 58.60585896291487, 56.43730707615363], 'dev_rel_ign': [50.47088686391705, 58.60585896291487, 54.23501874498241], 'dev_evi': [48.37214094374614, 48.03560466543892, 48.20328542094457]}58<00:00, 7138.58it/s]
6 {'dev_rel': [55.001567889620574, 56.93418810354621, 55.95119422624507], 'dev_rel_ign': [50.969505380567604, 56.93418810354621, 53.78698936397727], 'dev_evi': [48.379370908510296, 46.500920810313076, 47.42155098207997]}0:00, 6912.25it/s]
7 {'dev_rel': [64.34298005475166, 53.404203521869675, 58.36548268369474], 'dev_rel_ign': [60.185589453945866, 53.404203521869675, 56.59246987036146], 'dev_evi': [58.417906297789514, 42.99161039492531, 49.531443390110205]}:00, 7357.28it/s]
8 {'dev_rel': [58.90652557319223, 56.91795828937759, 57.89517127527858], 'dev_rel_ign': [54.660859845569995, 56.91795828937759, 55.766579943316565], 'dev_evi': [52.50690648327749, 45.697769592797215, 48.86627827466427]}00:00, 7233.11it/s]
9 {'dev_rel': [57.388071507672834, 58.873650896697235, 58.12136991788505], 'dev_rel_ign': [53.058556942263365, 58.873650896697235, 55.81505124951267], 'dev_evi': [50.993126589814366, 48.19930427665234, 49.5568704799474]}0:00, 7275.77it/s]
10 {'dev_rel': [52.68111035883548, 63.14209202304634, 57.439190934927844], 'dev_rel_ign': [48.56869523249047, 63.14209202304634, 54.90479655817136], 'dev_evi': [46.96384861607984, 51.03846940863516, 48.91645420670719]}<00:00, 7332.80it/s]
11 {'dev_rel': [64.66261278932915, 53.50158240688144, 58.55499800168745], 'dev_rel_ign': [60.5193950684644, 53.50158240688144, 56.79452104627279], 'dev_evi': [58.065410199556545, 42.86883568651525, 49.32313125367864]}9<00:00, 7280.85it/s]
12 {'dev_rel': [60.729278129887234, 59.871784468067844, 60.29748283752859], 'dev_rel_ign': [56.568047285782384, 59.871784468067844, 58.1730475535807], 'dev_evi': [54.37549721559268, 48.951299365664006, 51.52102514402627]}:00, 7249.74it/s]
13 {'dev_rel': [63.128641864634695, 57.14517568773837, 59.988073941562305], 'dev_rel_ign': [59.04202344249948, 57.14517568773837, 58.07811579654685], 'dev_evi': [56.875986115493845, 46.101903007980354, 50.92532421665301]}:00, 7369.29it/s]
14 {'dev_rel': [60.69063783421339, 58.76004219751684, 59.709738599818586], 'dev_rel_ign': [56.33553667597474, 58.76004219751684, 57.5222531516794], 'dev_evi': [53.860231041976434, 48.178841825250664, 50.86137063239185]}00:00, 7346.27it/s]
15 {'dev_rel': [60.233820459290186, 58.532824799156046, 59.371141657749604], 'dev_rel_ign': [55.7763743909952, 58.532824799156046, 57.12136509205015], 'dev_evi': [53.88101324657216, 47.44219357479026, 50.45701849836779]}0:00, 7111.26it/s]
16 {'dev_rel': [62.5143058367814, 57.623955205712896, 59.969597162401826], 'dev_rel_ign': [58.23852485461109, 57.623955205712896, 57.92961009848286], 'dev_evi': [55.82589558625749, 46.71577655003069, 50.86615050409402]}00:00, 7104.28it/s]
17 {'dev_rel': [62.42131585754937, 58.743812383348214, 60.526755852842804], 'dev_rel_ign': [58.16855436919893, 58.743812383348214, 58.45476812059089], 'dev_evi': [55.74605838978478, 47.57008389605075, 51.33456623147203]}0:00, 7218.68it/s]
18 {'dev_rel': [62.27229560562893, 58.532824799156046, 60.34468334309378], 'dev_rel_ign': [58.08957508574895, 58.532824799156046, 58.31035760723804], 'dev_evi': [55.919380220312306, 47.263147125025576, 51.22816745217632]}:00, 7216.64it/s]
19 {'dev_rel': [65.31986531986533, 56.67451107684817, 60.690853791005864], 'dev_rel_ign': [61.136149186525365, 56.67451107684817, 58.82084620392835], 'dev_evi': [58.5583822570124, 45.92285655821568, 51.47657549171397]}<00:00, 7204.61it/s]
20 {'dev_rel': [65.59977205812518, 56.04966323135601, 60.44985121652372], 'dev_rel_ign': [61.390043639921075, 56.04966323135601, 58.598430862013394], 'dev_evi': [59.10035529932291, 45.09924288929813, 51.159146960684744]}0:00, 7236.01it/s]
21 {'dev_rel': [64.79572713643178, 56.11458248803051, 60.143509458577945], 'dev_rel_ign': [60.63495383420479, 56.11458248803051, 58.28725707648724], 'dev_evi': [58.34595377625601, 45.32944546756701, 51.02058442493163]}<00:00, 7156.30it/s]
22 {'dev_rel': [65.32310857570374, 56.68262598393249, 60.696906499826206], 'dev_rel_ign': [61.132075407618366, 56.68262598393249, 58.82333062043635], 'dev_evi': [58.766618402000795, 45.67730714139554, 51.40176155661735]}0:00, 7215.40it/s]
23 {'dev_rel': [65.87901701323251, 56.56090237766777, 60.86538881369253], 'dev_rel_ign': [61.73009640439935, 56.56090237766777, 59.0325551807339], 'dev_evi': [59.21490352628077, 45.52895436873337, 51.47781826594945]}03<00:00, 7162.61it/s]
24 {'dev_rel': [63.42978874489614, 57.98912602450702, 60.58756199923694], 'dev_rel_ign': [59.21195915333931, 57.98912602450702, 58.59416329278141], 'dev_evi': [57.21337082161825, 46.84366687129118, 51.51182741259528]}8<00:00, 7296.51it/s]
25 {'dev_rel': [65.51852889013348, 56.95853282479916, 60.939399201250225], 'dev_rel_ign': [61.3921404040634, 56.95853282479916, 59.09229156014207], 'dev_evi': [59.18811881188118, 45.87170042971148, 51.68597613695314]}9<00:00, 6493.07it/s]
26 {'dev_rel': [65.644573244835, 56.9828775460521, 61.00781928757603], 'dev_rel_ign': [61.53846147405708, 56.9828775460521, 59.173118419691114], 'dev_evi': [59.54765536910526, 45.927972171066095, 51.85848375451263]}:58<00:00, 7278.33it/s]
27 {'dev_rel': [65.43778801843318, 57.615840298628584, 61.2782117119061], 'dev_rel_ign': [61.28033034457374, 57.615840298628584, 59.39161383381402], 'dev_evi': [59.15731802765458, 46.39860855330469, 52.00688073394496]}<00:00, 6999.87it/s]
28 {'dev_rel': [65.71110492624548, 57.47788687819525, 61.31936628863301], 'dev_rel_ign': [61.599999936, 57.47788687819525, 59.467595919684456], 'dev_evi': [59.378702119257596, 46.15305913648455, 51.937136606988666]}:00<00:00, 7110.25it/s]
29 {'dev_rel': [66.16583716780919, 57.17763531607562, 61.34424516803065], 'dev_rel_ign': [62.06170363055522, 57.17763531607562, 59.51964324241196], 'dev_evi': [59.885348620183976, 45.958665848168614, 52.00578871201158]}00:00, 6670.55it/s]
dev_F1_ign: 59.51964324241196 saving model checkpoint into bert_lambda0.1_seed66/2025-02-24_02:12:42.982369/best.ckpt ...
saving model checkpoint into bert_lambda0.1_seed66/2025-02-24_02:12:42.982369/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-02-24_02:12:42.982369/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-02-24_02:12:42.982369/scores.csv ...
             precision     recall         F1
dev_rel      66.165837  57.177635  61.344245
dev_rel_ign  62.061704  57.177635  59.519643
dev_evi      59.885349  45.958666  52.005789
saving topk results into bert_lambda0.1_seed66/2025-02-24_02:12:42.982369/topk_results.json ...
经过时间：3小时 14分钟 36秒
