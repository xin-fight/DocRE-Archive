(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [45.840057378518914, 41.49151992209689, 43.557524385568854], 'dev_rel_ign': [41.773493935640005, 41.49151992209689, 41.63202948137502], 'dev_evi': [40.31618102913826, 33.26683036627788, 36.45383709849207]}
1 {'dev_rel': [63.99624765478424, 27.67994806459466, 38.64498952019487], 'dev_rel_ign': [60.595482421775195, 27.67994806459466, 38.001056401368125], 'dev_evi': [58.399664851277755, 21.393492940454266, 31.315286981916213]}
2 {'dev_rel': [55.26241402054085, 47.59393004950093, 51.14230903383328], 'dev_rel_ign': [50.567412753183326, 47.59393004950093, 49.035635345718525], 'dev_evi': [49.86279890239122, 39.042357274401475, 43.7941125839215]}
3 {'dev_rel': [59.56885173779146, 43.950336768644, 50.58136819985991], 'dev_rel_ign': [55.115995048698416, 43.950336768644, 48.903931321400854], 'dev_evi': [53.2166508987701, 34.530386740331494, 41.88384214445272]}
4 {'dev_rel': [49.92364384835004, 61.0159863669561, 54.91527899503359], 'dev_rel_ign': [45.56870666457224, 61.0159863669561, 52.172962280482395], 'dev_evi': [45.0796493543218, 48.93083691426233, 46.92636020212923]}79it/s]
5 {'dev_rel': [59.153690507609745, 54.56463523492656, 56.766568172224574], 'dev_rel_ign': [54.73776559296377, 54.56463523492656, 54.651063298380244], 'dev_evi': [52.56689671873108, 44.41886638019235, 48.1506127654855]}/s]
6 {'dev_rel': [56.32821162680184, 57.713219183640355, 57.012305102408924], 'dev_rel_ign': [52.03549056016398, 57.713219183640355, 54.72748935340497], 'dev_evi': [49.82096354166667, 46.97667280540209, 48.35703001579779]}s]
7 {'dev_rel': [59.30044995330673, 56.68262598393249, 57.96199485519874], 'dev_rel_ign': [54.93937394967631, 56.68262598393249, 55.79738738300934], 'dev_evi': [53.22447047686665, 46.020053202373646, 49.36076817558299]}t/s]
8 {'dev_rel': [64.68762929251137, 50.75062890529903, 56.87781365103907], 'dev_rel_ign': [60.71346368157254, 50.75062890529903, 55.28679942300544], 'dev_evi': [58.54378969133067, 40.55657867812564, 47.917799939558776]}t/s]
9 {'dev_rel': [61.327231121281464, 56.54467256349914, 58.8389275913025], 'dev_rel_ign': [57.186007934145955, 56.54467256349914, 56.8635319810102], 'dev_evi': [54.77020990147482, 45.78473501125435, 49.87600657583104]}it/s]
10 {'dev_rel': [60.18871191135734, 56.42294895723444, 58.24502617801047], 'dev_rel_ign': [55.714973465849816, 56.42294895723444, 56.0667263328964], 'dev_evi': [53.558097531607466, 45.508491917331696, 49.20626140826373]}s]
11 {'dev_rel': [61.57763087368233, 55.9360545321756, 58.62142280052728], 'dev_rel_ign': [57.22100650763775, 55.9360545321756, 56.57123490103822], 'dev_evi': [55.413773691124035, 45.31921424186617, 49.860700717602356]}t/s]
12 {'dev_rel': [59.85203452527743, 59.084638480889396, 59.465860829794195], 'dev_rel_ign': [55.567685538966806, 59.084638480889396, 57.272220853037304], 'dev_evi': [53.554828714064385, 47.744014732965006, 50.48275862068965]}
13 {'dev_rel': [59.206821655538576, 59.72571614055019, 59.465136947564034], 'dev_rel_ign': [54.968475219813094, 59.72571614055019, 57.248436188757054], 'dev_evi': [52.8855776715223, 48.659709433190095, 50.68471252730858]}
14 {'dev_rel': [61.28353940617377, 59.125213016310965, 60.185032215430354], 'dev_rel_ign': [57.16147039817453, 59.125213016310965, 58.12676076711678], 'dev_evi': [54.75747353728045, 48.163494986699405, 51.24925153774972]}
15 {'dev_rel': [62.17875624945181, 57.526576320701125, 59.7622660596864], 'dev_rel_ign': [57.79996079682916, 57.526576320701125, 57.662944526353975], 'dev_evi': [55.43014032946919, 46.475342746060974, 50.55929656630865]}]
16 {'dev_rel': [63.26804400321975, 57.404852714436416, 60.194009530292725], 'dev_rel_ign': [59.04467485137148, 57.404852714436416, 58.213217936832294], 'dev_evi': [56.84125303605904, 46.690198485778595, 51.26808032579694]}
17 {'dev_rel': [64.69699830092506, 55.619573155887366, 59.81585722389493], 'dev_rel_ign': [60.37296030899242, 55.619573155887366, 57.8988695606032], 'dev_evi': [57.91333333333334, 44.439328831594025, 50.289452356142185]}]
18 {'dev_rel': [62.50999911119012, 57.072141523979546, 59.667430219733596], 'dev_rel_ign': [58.30779869693803, 57.072141523979546, 57.6833534982203], 'dev_evi': [56.36147443519619, 46.071209330877835, 50.69946801024574]}]
19 {'dev_rel': [63.35229759299781, 58.735697476263894, 60.95671214418055], 'dev_rel_ign': [59.111328067274094, 58.735697476263894, 58.922914121356506], 'dev_evi': [56.8483152901107, 47.81563331287088, 51.9422061683801]}s]
20 {'dev_rel': [66.15824594852239, 56.31745516513836, 60.842502082146154], 'dev_rel_ign': [62.10503836239856, 56.31745516513836, 59.06982042546298], 'dev_evi': [59.17100520624749, 45.34990791896869, 51.34665508253692]}/s]
21 {'dev_rel': [65.01908050154461, 58.070275095350155, 61.34853615671481], 'dev_rel_ign': [60.92164021424925, 58.070275095350155, 59.46179448068774], 'dev_evi': [58.623326959847034, 47.05340699815838, 52.20500595947557]}]
22 {'dev_rel': [65.2894100130281, 56.93418810354621, 60.82621700117039], 'dev_rel_ign': [61.14178553897095, 56.93418810354621, 58.96301866460296], 'dev_evi': [59.0170380078637, 46.071209330877835, 51.74672489082969]}it/s]
23 {'dev_rel': [66.45124501045429, 56.73943033352268, 61.21251915079886], 'dev_rel_ign': [62.3867873602698, 56.73943033352268, 59.429248131744814], 'dev_evi': [59.93559640413256, 45.70288520564764, 51.860451616648284]}/s]
24 {'dev_rel': [65.18396485447556, 57.79436825448349, 61.26715127532367], 'dev_rel_ign': [60.964597166788515, 57.79436825448349, 59.3371686364069], 'dev_evi': [59.02643455834945, 46.83343564559034, 52.2277368931485]}it/s]
25 {'dev_rel': [66.90391459074732, 56.44729367848738, 61.232394366197184], 'dev_rel_ign': [62.84418522530593, 56.44729367848738, 59.474225854120064], 'dev_evi': [60.58683043329921, 45.42152649887456, 51.91942227290003]}s]
26 {'dev_rel': [66.54946308087048, 56.828694311450136, 61.30613674166157], 'dev_rel_ign': [62.437306517514344, 56.828694311450136, 59.501124898160015], 'dev_evi': [60.0564099120274, 45.74892572130141, 51.93530590319114]}]
27 {'dev_rel': [66.24221581931407, 57.83494278990505, 61.753747508881375], 'dev_rel_ign': [62.174546904629715, 57.83494278990505, 59.926283702567616], 'dev_evi': [59.86833443054641, 46.52138326171475, 52.3576486844378]}s]
28 {'dev_rel': [66.93831138065005, 57.323703643593284, 61.75904878475259], 'dev_rel_ign': [62.85927180875104, 57.323703643593284, 59.96400496584036], 'dev_evi': [60.59173196433396, 45.887047268262734, 52.22403353516535]}]
29 {'dev_rel': [66.51689600299542, 57.664529741134466, 61.77518908110928], 'dev_rel_ign': [62.42647052266127, 57.664529741134466, 59.95108806123079], 'dev_evi': [60.07566706491437, 46.301411909146715, 52.29675853700814]}]
saving model checkpoint into bert_lambda0.1_seed66/2025-01-07_23:37:09.896730/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-01-07_23:37:09.896730/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-01-07_23:37:09.896730/scores.csv ...
             precision     recall         F1
dev_rel      66.938311  57.323704  61.759049
dev_rel_ign  62.859272  57.323704  59.964005
dev_evi      60.591732  45.887047  52.224034
saving topk results into bert_lambda0.1_seed66/2025-01-07_23:37:09.896730/topk_results.json ...
经过时间：3小时 15分钟 51秒