(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi
####################
**********
save_path: ./Save/use_graphFalse_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: False
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 115448936
trainable_num/total_num: 115.45M / 115.45M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
Saving to ./feature_file/train_annotated_feature.pkl
Save  ./feature_file/train_annotated_feature.pkl  !!!
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Saving to ./feature_file/dev_feature.pkl
Save  ./feature_file/dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [62.17475104400899, 31.412805323379047, 41.73809908889967], 'dev_rel_ign': [58.392226045243426, 31.412805323379047, 40.849907877185146], 'dev_evi': [56.01440306065039, 25.46552076938817, 35.013187972569014]}:00, 7038.35it/s]
1 {'dev_rel': [62.86967825804355, 31.396575509210418, 41.87909292634085], 'dev_rel_ign': [59.138054257621505, 31.396575509210418, 41.0170647574112], 'dev_evi': [57.39423888152344, 24.360548393697563, 34.20362722212246]}00:00, 6824.55it/s]
2 {'dev_rel': [57.9701996064099, 50.19881522356569, 53.805340523614866], 'dev_rel_ign': [53.76765276387212, 50.19881522356569, 51.92198058367404], 'dev_evi': [51.62865403148089, 41.10906486597094, 45.772221114686864]}9<00:00, 7213.04it/s]
3 {'dev_rel': [57.16720640872678, 54.43479672157754, 55.76755206384837], 'dev_rel_ign': [53.27693589915688, 54.43479672157754, 53.84964302506915], 'dev_evi': [51.50864639236732, 44.188663801923475, 47.5686987168897]}00<00:00, 7174.16it/s]
4 {'dev_rel': [48.14178829878572, 63.70202061186399, 54.83949841070243], 'dev_rel_ign': [43.88479657317354, 63.70202061186399, 51.96826691217604], 'dev_evi': [43.34618884603718, 51.171475342746064, 46.934897360703815]}<00:00, 7023.90it/s]
5 {'dev_rel': [61.42590866728798, 53.48535259271281, 57.18127792478202], 'dev_rel_ign': [57.334295374359044, 53.48535259271281, 55.34298402867166], 'dev_evi': [55.39079194457035, 43.758952322488234, 48.892572375753765]}00:00, 7086.88it/s]
6 {'dev_rel': [58.610121759297606, 57.42108252860505, 58.00950975569765], 'dev_rel_ign': [54.568597095582696, 57.42108252860505, 55.95851203094069], 'dev_evi': [51.76181214963963, 46.29118068344587, 48.87388603834729]}<00:00, 7197.03it/s]
7 {'dev_rel': [65.44267645858834, 52.065243852957884, 57.99249785330141], 'dev_rel_ign': [61.38591285458638, 52.065243852957884, 56.34270490779279], 'dev_evi': [59.179589794897446, 42.362390014323715, 49.37837273784324]}0:00, 7112.47it/s]
8 {'dev_rel': [59.834193384654434, 57.3967378073521, 58.59012591119948], 'dev_rel_ign': [55.48054378295307, 57.3967378073521, 56.422376231161444], 'dev_evi': [53.24881141045958, 46.408839779005525, 49.59409594095941]}0<00:00, 7118.79it/s]
9 {'dev_rel': [62.83702399703511, 55.035299845816766, 58.67797196746841], 'dev_rel_ign': [58.73456784080806, 55.035299845816766, 56.82479233142958], 'dev_evi': [56.78738926524232, 44.59791282995703, 49.95988538681949]}<00:00, 7169.82it/s]
10 {'dev_rel': [62.217807476973086, 55.91170981092266, 58.89643971449331], 'dev_rel_ign': [58.05093236610092, 55.91170981092266, 56.96124313553895], 'dev_evi': [56.290881108118505, 44.9048496009822, 49.95731603209835]}<00:00, 7148.61it/s]
11 {'dev_rel': [60.88270858524788, 57.20198003732857, 58.984979707962005], 'dev_rel_ign': [56.53133692625843, 57.20198003732857, 56.864681215173505], 'dev_evi': [53.771231737736066, 46.316758747697975, 49.766393667894235]}00, 7218.07it/s]
12 {'dev_rel': [60.57220247164381, 58.070275095350155, 59.29485851597133], 'dev_rel_ign': [56.44693776863306, 58.070275095350155, 57.2471006329488], 'dev_evi': [54.667542079503406, 46.85389809699202, 50.46002975042698]}00:00, 7151.07it/s]
13 {'dev_rel': [60.372362432767886, 59.206362087154105, 59.78367748279253], 'dev_rel_ign': [56.22886385501429, 59.206362087154105, 57.67921266628107], 'dev_evi': [53.83817427385892, 47.790055248618785, 50.63414634146341]}:00, 6859.60it/s]
14 {'dev_rel': [62.29753521126761, 57.42919743568936, 59.76438795760672], 'dev_rel_ign': [58.046821375211266, 57.42919743568936, 57.73635772341885], 'dev_evi': [55.47836684948202, 46.57253939021895, 50.63685410756994]}<00:00, 7139.83it/s]
15 {'dev_rel': [61.27236920969261, 58.070275095350155, 59.62836430297476], 'dev_rel_ign': [57.00978988973502, 58.070275095350155, 57.535146203716316], 'dev_evi': [54.96553790830087, 46.91528545119705, 50.62236083128639]}0:00, 7253.02it/s]
16 {'dev_rel': [59.75308641975309, 60.878032946522765, 60.31031433394968], 'dev_rel_ign': [55.47625336551568, 60.878032946522765, 58.051753608428626], 'dev_evi': [53.477994087131144, 49.04338039697156, 51.164776517678455]}00, 7180.63it/s]
17 {'dev_rel': [65.00332667997338, 55.49784954962266, 59.87567851514621], 'dev_rel_ign': [60.87141332532262, 55.49784954962266, 58.060564364526826], 'dev_evi': [59.017615176151764, 44.562103540004095, 50.781158913372984]}:00, 6893.10it/s]
18 {'dev_rel': [62.70586151939083, 57.46977197111093, 59.97374772409704], 'dev_rel_ign': [58.55962213837109, 57.46977197111093, 58.00957863885945], 'dev_evi': [56.23345441113094, 46.72600777573153, 51.04076443798721]}0<00:00, 7142.47it/s]
19 {'dev_rel': [65.06237199776578, 56.715085612269746, 60.60264469976154], 'dev_rel_ign': [60.84507035905574, 56.715085612269746, 58.707533109094], 'dev_evi': [58.62765541509189, 46.02516881522406, 51.567604745801574]}<00:00, 7148.90it/s]
20 {'dev_rel': [63.534675615212535, 57.615840298628584, 60.43067495105966], 'dev_rel_ign': [59.42851447687324, 57.615840298628584, 58.50814088132231], 'dev_evi': [57.391689891056494, 46.35256803765091, 51.284808693683495]}00, 7083.98it/s]
21 {'dev_rel': [63.296276689606486, 58.21634342286781, 60.65012469882065], 'dev_rel_ign': [59.047056449057834, 58.21634342286781, 58.628757482764996], 'dev_evi': [56.9304466840861, 46.812973194188665, 51.378361686598176]}:00, 7134.61it/s]
22 {'dev_rel': [62.08099370427088, 59.21447699423842, 60.61386385347011], 'dev_rel_ign': [57.85741295588369, 59.21447699423842, 58.528079624954465], 'dev_evi': [55.7983093225384, 47.94863924698179, 51.57651460958566]}0<00:00, 7243.30it/s]
23 {'dev_rel': [64.20660856935366, 57.3967378073521, 60.6109944727709], 'dev_rel_ign': [60.02635841440961, 57.3967378073521, 58.68210371382627], 'dev_evi': [57.83024315134407, 46.112134233681196, 51.310658887149565]}55<00:00, 7232.59it/s]
24 {'dev_rel': [63.85035353083326, 57.89174713949525, 60.72522982635342], 'dev_rel_ign': [59.59383747539633, 57.89174713949525, 58.730462660702045], 'dev_evi': [57.725281005905885, 46.500920810313076, 51.50871228219294]}0:00, 7131.14it/s]
25 {'dev_rel': [63.522398527220126, 58.8006167329384, 61.07037505267594], 'dev_rel_ign': [59.33743764356745, 58.8006167329384, 59.06780752752797], 'dev_evi': [57.34847074880576, 47.28872518927768, 51.83502957916281]}59<00:00, 7247.38it/s]
26 {'dev_rel': [64.75670759436107, 57.77813844031486, 61.068702290076345], 'dev_rel_ign': [60.59188440903907, 57.77813844031486, 59.15156897790737], 'dev_evi': [58.33493312855954, 46.63392674442398, 51.83226723525232]}<00:00, 2244.83it/s]
27 {'dev_rel': [64.01914723871998, 58.60585896291487, 61.19301813251992], 'dev_rel_ign': [59.87941083337016, 58.60585896291487, 59.23579044241595], 'dev_evi': [57.76218518982583, 47.16595048086761, 51.92903407490847]}8<00:00, 7173.20it/s]
28 {'dev_rel': [64.80137855976781, 57.98101111742271, 61.20176452953018], 'dev_rel_ign': [60.63095956519481, 57.98101111742271, 59.27638366309941], 'dev_evi': [58.68638594678378, 46.485573971761816, 51.87828271294816]}<00:00, 7100.58it/s]
29 {'dev_rel': [64.18480675255442, 58.622088777083505, 61.27746204088558], 'dev_rel_ign': [60.01785354094638, 58.622088777083505, 59.31176077371815], 'dev_evi': [57.97979797979798, 46.981788418252506, 51.90460042952413]}0:00, 7209.39it/s]
dev_F1_ign: 59.31176077371815 saving model checkpoint into bert_lambda0.1_seed66/2025-02-23_02:20:37.459648/best.ckpt ...
saving model checkpoint into bert_lambda0.1_seed66/2025-02-23_02:20:37.459648/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-02-23_02:20:37.459648/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-02-23_02:20:37.459648/scores.csv ...
             precision     recall         F1
dev_rel      64.184807  58.622089  61.277462
dev_rel_ign  60.017854  58.622089  59.311761
dev_evi      57.979798  46.981788  51.904600
saving topk results into bert_lambda0.1_seed66/2025-02-23_02:20:37.459648/topk_results.json ...
经过时间：2小时 55分钟 38秒
