(DREEAM) root@autodl-container-9d8d46936f-c9a70c19:~/autodl-tmp/Code/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [42.986220917099615, 46.32800454434797, 44.5945945945946], 'dev_rel_ign': [39.399759872429165, 46.32800454434797, 42.58392288272243], 'dev_evi': [37.27548036758563, 36.52036013914467, 36.89405684754522]}4<00:00, 6572.29it/s]
1 {'dev_rel': [58.392026578073086, 35.65690172847521, 44.27650141072148], 'dev_rel_ign': [54.65604626407524, 35.65690172847521, 43.158047961536575], 'dev_evi': [53.01967660237678, 27.844280744833235, 36.51304756154826]}00:00, 6528.49it/s]
2 {'dev_rel': [58.03801924430885, 40.13633043901647, 47.45502518589589], 'dev_rel_ign': [53.774560426868454, 40.13633043901647, 45.96513794311588], 'dev_evi': [51.485309676894275, 32.36136689175363, 39.74242186272971]}<00:00, 6473.73it/s]
3 {'dev_rel': [53.17731188038355, 53.10395195975006, 53.14060660197328], 'dev_rel_ign': [48.93202158208631, 53.10395195975006, 50.93269820811079], 'dev_evi': [47.596537191024034, 42.751176590955595, 45.04392820568102]}<00:00, 6593.65it/s]
4 {'dev_rel': [48.67156585641605, 62.88241499634829, 54.8718311853845], 'dev_rel_ign': [44.457282644968885, 62.88241499634829, 52.088488384465336], 'dev_evi': [43.19285131245436, 51.432371598117456, 46.95388207822534]}<00:00, 6619.63it/s]
5 {'dev_rel': [61.63153417147178, 52.90919418972653, 56.9382586673653], 'dev_rel_ign': [57.5196231737105, 52.90919418972653, 55.11816543686693], 'dev_evi': [55.045103092783506, 43.70268058113362, 48.72248203490362]}:05<00:00, 6522.02it/s]
6 {'dev_rel': [50.16408210539862, 63.26381562931105, 55.9575078954924], 'dev_rel_ign': [45.97139864250339, 63.26381562931105, 53.248874135111556], 'dev_evi': [43.78074490513001, 50.99242889298138, 47.112203421873524]}4<00:00, 6464.76it/s]
7 {'dev_rel': [59.82569345512444, 57.93232167491682, 58.863786279683374], 'dev_rel_ign': [55.549374079230994, 57.93232167491682, 56.71582869135392], 'dev_evi': [53.80130597014925, 47.20687538367096, 50.288828337874655]}00:00, 6545.06it/s]
8 {'dev_rel': [59.01349072512647, 56.79623468311288, 57.88363726584791], 'dev_rel_ign': [54.63792454774363, 56.79623468311288, 55.69617802352595], 'dev_evi': [52.7395253442719, 46.04051565377532, 49.16286564881325]}:01<00:00, 6573.21it/s]
9 {'dev_rel': [60.27234042553191, 57.46977197111093, 58.837701989781074], 'dev_rel_ign': [56.214238761641276, 57.46977197111093, 56.83507227336716], 'dev_evi': [54.17489674986533, 46.301411909146715, 49.929664873810516]}0:00, 6564.58it/s]
10 {'dev_rel': [59.35254838982335, 56.9828775460521, 58.143578703320365], 'dev_rel_ign': [55.014031753962556, 56.9828775460521, 55.981149021766086], 'dev_evi': [53.027004765546856, 46.10701862083077, 49.325489122999045]}0:00, 6472.58it/s]
11 {'dev_rel': [59.44073047448231, 59.16578755173253, 59.30294033917605], 'dev_rel_ign': [55.33710381960939, 59.16578755173253, 57.187434991508304], 'dev_evi': [53.060762217566115, 47.933292408430525, 50.36686644986158]}0:00, 6421.95it/s]
12 {'dev_rel': [63.477941850866735, 56.163271930536396, 59.59700335830536], 'dev_rel_ign': [59.43771003418793, 56.163271930536396, 57.75411618211213], 'dev_evi': [56.67051134179162, 45.242480049109886, 50.31575354155999]}:00, 6199.59it/s]
13 {'dev_rel': [61.12016467964663, 57.826827882820744, 59.42790426152948], 'dev_rel_ign': [57.000569097893596, 57.826827882820744, 57.41072575215348], 'dev_evi': [54.38345550986352, 46.67996726007776, 50.23811490076252]}0:00, 6629.79it/s]
14 {'dev_rel': [60.877149264889105, 59.47415402093647, 60.16747393481652], 'dev_rel_ign': [56.68168853427602, 59.47415402093647, 58.044354892469464], 'dev_evi': [54.23240815386387, 48.178841825250664, 51.026710733055204]}:00, 6600.56it/s]
15 {'dev_rel': [61.01884519404527, 57.54280613486975, 59.22986969595723], 'dev_rel_ign': [56.89409072519356, 57.54280613486975, 57.21660972374768], 'dev_evi': [54.54055026074447, 46.54696132596685, 50.227705556015565]}<00:00, 6580.28it/s]
16 {'dev_rel': [61.30067567567568, 58.89799561795017, 60.07532177295866], 'dev_rel_ign': [57.14152085198623, 58.89799561795017, 58.006464472216834], 'dev_evi': [54.718412605777644, 47.963986085533044, 51.119046969986094]}:00, 6514.02it/s]
17 {'dev_rel': [65.50435865504357, 55.489734642538345, 60.08259379667867], 'dev_rel_ign': [61.47426975342434, 55.489734642538345, 58.328900990997255], 'dev_evi': [58.664175618869685, 44.97646818088807, 50.916461560735485]}00, 6539.16it/s]
18 {'dev_rel': [64.07393850658858, 56.82057940436582, 60.22966754118103], 'dev_rel_ign': [59.963287721840416, 56.82057940436582, 58.34964769001223], 'dev_evi': [57.09781169199722, 46.316758747697975, 51.14531845784494]}00:00, 6358.17it/s]
19 {'dev_rel': [64.99952638060054, 55.68449241256188, 59.98251748251748], 'dev_rel_ign': [60.86219673672048, 55.68449241256188, 58.15833220378751], 'dev_evi': [58.54428254884845, 44.60302844280745, 50.631514764379645]}<00:00, 6458.08it/s]
20 {'dev_rel': [63.67068128707531, 57.48600178527956, 60.420487014371616], 'dev_rel_ign': [59.44210309106753, 57.48600178527956, 58.44769053646244], 'dev_evi': [57.06644852756104, 46.393492940454266, 51.17945823927765]}00:00, 6399.46it/s]
21 {'dev_rel': [62.67063353167658, 58.118964537856044, 60.30903961938444], 'dev_rel_ign': [58.48175176790097, 58.118964537856044, 58.29979377137874], 'dev_evi': [55.86874467307926, 46.94597912829957, 51.020181242008114]}0:00, 6569.60it/s]
22 {'dev_rel': [64.82162559764619, 57.21009494441288, 60.778481831113396], 'dev_rel_ign': [60.77506657701962, 57.21009494441288, 58.93872219673496], 'dev_evi': [58.15446469100577, 45.8768160425619, 51.29114358431753]}5<00:00, 6607.78it/s]
23 {'dev_rel': [65.79520697167756, 56.366144607644245, 60.71678321678321], 'dev_rel_ign': [61.71137730706035, 56.366144607644245, 58.91777470972615], 'dev_evi': [59.41011235955056, 45.44198895027624, 51.495652173913044]}0:00, 6531.10it/s]
24 {'dev_rel': [65.39141766731825, 57.00722226730504, 60.91216509147662], 'dev_rel_ign': [61.347333338863365, 57.00722226730504, 59.097700958673826], 'dev_evi': [58.98095049766001, 45.77450378555351, 51.545263400443574]}0:00, 6582.94it/s]
25 {'dev_rel': [65.53719779706898, 56.97476263896778, 60.95676332696649], 'dev_rel_ign': [61.36863025910995, 56.97476263896778, 59.09012842825396], 'dev_evi': [59.01639344262295, 46.04051565377532, 51.72711075349158]}0<00:00, 6345.81it/s]
26 {'dev_rel': [64.37973314100253, 57.94855148908545, 60.995088618407], 'dev_rel_ign': [60.239508845487066, 57.94855148908545, 59.07182620863768], 'dev_evi': [58.16267942583732, 46.6390423572744, 51.767311131930846]}05<00:00, 6492.85it/s]
27 {'dev_rel': [65.30198248040571, 57.46977197111093, 61.136049723756905], 'dev_rel_ign': [61.22217635900435, 57.46977197111093, 59.286658689625725], 'dev_evi': [58.862330198537094, 46.10701862083077, 51.70969592656339]}0:00, 6520.75it/s]
28 {'dev_rel': [65.35027156402468, 57.607725391544264, 61.23522815492108], 'dev_rel_ign': [61.27572010156819, 57.607725391544264, 59.38513713391287], 'dev_evi': [58.947780168198705, 46.255371393492936, 51.83592742282226]}:00, 6468.75it/s]
29 {'dev_rel': [65.35374965409095, 57.494116692363875, 61.17250906579174], 'dev_rel_ign': [61.29829978227893, 57.494116692363875, 59.33529606207036], 'dev_evi': [58.940095169806405, 46.255371393492936, 51.83295594600017]}:00, 6448.57it/s]
saving model checkpoint into bert_lambda0.1_seed66/2025-02-23_19:09:38.243569/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-02-23_19:09:38.243569/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-02-23_19:09:38.243569/scores.csv ...
             precision     recall         F1
dev_rel      65.350272  57.607725  61.235228
dev_rel_ign  61.275720  57.607725  59.385137
dev_evi      58.947780  46.255371  51.835927
saving topk results into bert_lambda0.1_seed66/2025-02-23_19:09:38.243569/topk_results.json ...
经过时间：3小时 20分钟 56秒
