(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [57.476635514018696, 30.942140712488843, 40.2278841588859], 'dev_rel_ign': [53.170650642147, 30.942140712488843, 39.11922853700949], 'dev_evi': [50.7020757020757, 25.49109883364027, 33.92565359477124]}
1 {'dev_rel': [62.066914498141266, 33.871622169926155, 43.82612347753045], 'dev_rel_ign': [58.41212902117358, 33.871622169926155, 42.87891505946903], 'dev_evi': [57.10297433694835, 27.204829138530794, 36.85249991337792]}
2 {'dev_rel': [60.286298568507156, 47.845492169114664, 53.350223951499785], 'dev_rel_ign': [55.923740290599476, 47.845492169114664, 51.570177685958186], 'dev_evi': [53.414264036418814, 39.615305913648456, 45.491393996357864]}
3 {'dev_rel': [65.93537617741742, 44.87543617625578, 53.4041525832931], 'dev_rel_ign': [62.283828300615404, 44.87543617625578, 52.16560556591735], 'dev_evi': [59.2203769038809, 35.20564763658686, 44.15926080400398]}
4 {'dev_rel': [52.67801319902744, 61.53534042035219, 56.763230780747065], 'dev_rel_ign': [48.370471389744985, 61.53534042035219, 54.16444088332387], 'dev_evi': [46.920778720123366, 49.81072232453448, 48.32258064516129]}
5 {'dev_rel': [59.465038272985296, 56.106467580946195, 57.73695198329853], 'dev_rel_ign': [55.45789617667716, 56.106467580946195, 55.78029666720706], 'dev_evi': [53.05685936664488, 45.68242275424596, 49.09425767613184]}
6 {'dev_rel': [57.25344480569747, 60.01785279558549, 58.603066439523], 'dev_rel_ign': [53.3654251723964, 60.01785279558549, 56.496483251704454], 'dev_evi': [50.110841338541114, 48.567628401882544, 49.32716787031745]}
7 {'dev_rel': [61.29403434236148, 56.19573155887365, 58.634266119131276], 'dev_rel_ign': [57.14425709805542, 56.19573155887365, 56.66602529375251], 'dev_evi': [55.078197440811024, 45.58011049723757, 49.881035689293206]}
8 {'dev_rel': [58.196787472758096, 58.508480077903116, 58.35221754613145], 'dev_rel_ign': [54.00532854884074, 58.508480077903116, 56.16678926908892], 'dev_evi': [51.84601530841964, 47.12502557806425, 49.37292314288777]}
9 {'dev_rel': [63.006708872720395, 54.110200438204984, 58.220553566751065], 'dev_rel_ign': [58.876050358323475, 54.110200438204984, 56.39261172823371], 'dev_evi': [56.652758460825225, 43.758952322488234, 49.37801252633706]}
10 {'dev_rel': [58.03011292346299, 60.05031242392275, 59.02293120638086], 'dev_rel_ign': [53.889893983036195, 60.05031242392275, 56.80356517198221], 'dev_evi': [51.65900131406045, 48.2658072437078, 49.904792129482715]}
11 {'dev_rel': [61.214871705358696, 56.91795828937759, 58.98826794499811], 'dev_rel_ign': [56.9504988308142, 56.91795828937759, 56.934223910490275], 'dev_evi': [54.72128118263012, 45.44710456312666, 49.654864041583984]}
12 {'dev_rel': [63.489062921955174, 57.234439665665825, 60.19972686923866], 'dev_rel_ign': [59.31387294682128, 57.234439665665825, 58.25560587563735], 'dev_evi': [56.311224808136274, 46.16840597503581, 50.737877723120164]}
13 {'dev_rel': [59.35018050541516, 60.034082609754115, 59.690172664192346], 'dev_rel_ign': [55.119574796173985, 60.034082609754115, 57.471958447021585], 'dev_evi': [52.84769683836195, 48.65459382033968, 50.66453589026501]}
14 {'dev_rel': [63.569086651053865, 55.06775947415402, 59.0138272893295], 'dev_rel_ign': [59.64092978451543, 55.06775947415402, 57.26318376426542], 'dev_evi': [57.30878373919356, 44.423981993042766, 50.0504308233192]}
15 {'dev_rel': [60.602998147212396, 58.39487137872271, 59.47844774145557], 'dev_rel_ign': [56.177985895852004, 58.39487137872271, 57.26498123097722], 'dev_evi': [53.89773191067576, 47.28872518927768, 50.37739447941361]}
16 {'dev_rel': [61.17145721925134, 59.40923476426195, 60.27746902144827], 'dev_rel_ign': [56.988152483350476, 59.40923476426195, 58.17351419517147], 'dev_evi': [54.68385440970602, 47.95887047268263, 51.101057451215524]}
17 {'dev_rel': [66.14805272024576, 54.16700478779518, 59.56098866779691], 'dev_rel_ign': [62.0823620134506, 54.16700478779518, 57.85520718009063], 'dev_evi': [59.60422348087546, 43.605483936975645, 50.364855682590324]}
18 {'dev_rel': [62.51515676424736, 58.573399334577616, 60.480120658594814], 'dev_rel_ign': [58.36459830845156, 58.573399334577616, 58.4688124070497], 'dev_evi': [56.181401519720175, 47.65704931450788, 51.5693329642956]}
19 {'dev_rel': [65.24769960033461, 56.96664773188347, 60.826618144008314], 'dev_rel_ign': [61.003337441590176, 56.96664773188347, 58.91592898641302], 'dev_evi': [58.46690796277145, 46.27583384489462, 51.66190748143917]}
20 {'dev_rel': [65.27674591381873, 57.03968189564229, 60.880862673769], 'dev_rel_ign': [61.07235808321462, 57.03968189564229, 58.987176553836605], 'dev_evi': [59.14972273567468, 45.835891139758544, 51.64860502651602]}
21 {'dev_rel': [64.42403854895899, 57.50223159944818, 60.7666580910728], 'dev_rel_ign': [60.29023740583496, 57.50223159944818, 58.86324013363783], 'dev_evi': [57.86327503974563, 46.54696132596685, 51.591869135032454]}
22 {'dev_rel': [63.05401662049861, 59.10898320214234, 61.017801047120415], 'dev_rel_ign': [58.89434647125653, 59.10898320214234, 59.00146963489294], 'dev_evi': [56.67942409331146, 47.72866789441375, 51.82037823877364]}
23 {'dev_rel': [65.97801364670205, 56.495983120993266, 60.869945355191255], 'dev_rel_ign': [61.84098632882549, 56.495983120993266, 59.047774099039195], 'dev_evi': [59.46886079336411, 45.47779824022918, 51.540713685247994]}
24 {'dev_rel': [65.39551897576588, 58.029700559928585, 61.49281967495056], 'dev_rel_ign': [61.26919133954024, 58.029700559928585, 59.60546272263105], 'dev_evi': [58.917939425317115, 46.57253939021895, 52.022857142857134]}
25 {'dev_rel': [65.30127091524184, 57.956666396169766, 61.41014617368874], 'dev_rel_ign': [61.16057715570508, 57.956666396169766, 59.515533790315104], 'dev_evi': [58.75943000838223, 46.61857990587273, 51.989616909604365]}
26 {'dev_rel': [65.95226953673374, 57.18575022315995, 61.25695410292072], 'dev_rel_ign': [61.8338228474257, 57.18575022315995, 59.419025921038084], 'dev_evi': [59.52238408833899, 45.77450378555351, 51.75096151065613]}
27 {'dev_rel': [65.57950985811682, 57.76190862614623, 61.42296241964016], 'dev_rel_ign': [61.500412137777815, 57.76190862614623, 59.57256514242217], 'dev_evi': [59.14531026408222, 46.516267648864336, 52.07605520875093]}
28 {'dev_rel': [65.11690891035478, 58.532824799156046, 61.64957264957266], 'dev_rel_ign': [60.98152068970866, 58.532824799156046, 59.73208742291768], 'dev_evi': [58.59050539901604, 46.91016983834663, 52.10375294752693]}
29 {'dev_rel': [65.61925762587283, 57.956666396169766, 61.55039427758866], 'dev_rel_ign': [61.48224388936465, 57.956666396169766, 59.667421443569815], 'dev_evi': [59.17155903457273, 46.40372416615511, 52.01559722461151]}
saving model checkpoint into bert_lambda0.1_seed66/2025-01-07_16:00:30.066719/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-01-07_16:00:30.066719/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-01-07_16:00:30.066719/scores.csv ...
             precision     recall         F1
dev_rel      65.116909  58.532825  61.649573
dev_rel_ign  60.981521  58.532825  59.732087
dev_evi      58.590505  46.910170  52.103753
saving topk results into bert_lambda0.1_seed66/2025-01-07_16:00:30.066719/topk_results.json ...
经过时间：3小时 18分钟 11秒
