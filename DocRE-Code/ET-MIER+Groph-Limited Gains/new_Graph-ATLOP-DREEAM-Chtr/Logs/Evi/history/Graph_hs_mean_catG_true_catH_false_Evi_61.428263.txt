(DREEAM) root@autodl-container-9d8d46936f-c9a70c19:~/autodl-tmp/Code/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
Saving to ./feature_file/train_annotated_feature.pkl
Save  ./feature_file/train_annotated_feature.pkl  !!!
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Saving to ./feature_file/dev_feature.pkl
Save  ./feature_file/dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [60.892628498262305, 27.014525683680922, 37.42551995503092], 'dev_rel_ign': [57.747035458997956, 27.014525683680922, 36.80934497979751], 'dev_evi': [55.34804753820034, 21.679967260077756, 31.15603749310788]}:00, 6339.41it/s]
1 {'dev_rel': [57.62644889357218, 35.502718493873246, 43.93673110720562], 'dev_rel_ign': [53.44428356954518, 35.502718493873246, 42.66399790120989], 'dev_evi': [50.88822082536212, 28.575813382443215, 36.599508599508596]}0:00, 6205.06it/s]
2 {'dev_rel': [59.20548497680984, 47.650734399091135, 52.80338114293423], 'dev_rel_ign': [54.620906174718584, 47.650734399091135, 50.898299434060554], 'dev_evi': [52.69162453887143, 39.456721915285456, 45.12373486222431]}:00, 6308.69it/s]
3 {'dev_rel': [56.81895380434783, 54.29684330114421, 55.5292750736545], 'dev_rel_ign': [52.741635638715955, 54.29684330114421, 53.507941332581574], 'dev_evi': [51.073519843851656, 44.17331696337221, 47.37347414620765]}<00:00, 6334.69it/s]
4 {'dev_rel': [48.18030666912988, 63.491033027671826, 54.786079406204045], 'dev_rel_ign': [43.862575020772134, 63.491033027671826, 51.88237731266345], 'dev_evi': [43.288488990786, 51.191937794147734, 46.90964490800422]}00:00, 6030.62it/s]
5 {'dev_rel': [57.48750099198476, 58.78438691876978, 58.128711282298184], 'dev_rel_ign': [53.5103705167835, 58.78438691876978, 56.02352944091087], 'dev_evi': [51.632597437994, 48.455084919173316, 49.99340247539123]}:07<00:00, 6320.36it/s]
6 {'dev_rel': [55.97191482866519, 59.51472855635803, 57.68897978447258], 'dev_rel_ign': [51.92900587290309, 59.51472855635803, 55.46369573049563], 'dev_evi': [49.62232480067142, 48.393697564968285, 49.00031078421216]}6<00:00, 6564.27it/s]
7 {'dev_rel': [58.72247761916284, 59.084638480889396, 58.903001375293265], 'dev_rel_ign': [54.587400129026264, 59.084638480889396, 56.74705656160951], 'dev_evi': [52.27838990089142, 48.301616533660734, 50.211385572602296]}00, 6320.89it/s]
8 {'dev_rel': [57.034043214674334, 59.54718818469529, 58.26352773035849], 'dev_rel_ign': [52.91712796787571, 59.54718818469529, 56.03672853924452], 'dev_evi': [51.62540842886415, 47.68774299161039, 49.578513495545806]}<00:00, 6472.07it/s]
9 {'dev_rel': [62.618472402899094, 54.68635884119127, 58.384232185401785], 'dev_rel_ign': [58.20259734212717, 54.68635884119127, 56.38971660916581], 'dev_evi': [56.567242281527996, 44.239819930427664, 49.649787576070736]}:00, 6381.84it/s]
10 {'dev_rel': [58.64575675896431, 58.26503286537369, 58.45477489212734], 'dev_rel_ign': [54.32566526447843, 58.26503286537369, 56.22643299391509], 'dev_evi': [51.91661062542031, 47.39103744628606, 49.55070603337612]}6<00:00, 6490.22it/s]
11 {'dev_rel': [64.9167733674776, 53.48535259271281, 58.64922584089696], 'dev_rel_ign': [60.74931122782446, 53.48535259271281, 56.886381455792275], 'dev_evi': [57.826116327771395, 43.789645999590746, 49.83843265116008]}00:00, 6281.35it/s]
12 {'dev_rel': [61.30339355056559, 58.93045524628743, 60.09350821300011], 'dev_rel_ign': [57.12281352808641, 58.93045524628743, 58.012556504608135], 'dev_evi': [55.11180198493364, 47.155719255166765, 50.824281854772]}5<00:00, 6433.67it/s]
13 {'dev_rel': [62.108963093145874, 57.35616327193054, 59.6380205037337], 'dev_rel_ign': [57.845341619077786, 57.35616327193054, 57.5997138503246], 'dev_evi': [55.71322803553801, 46.193984039287905, 50.50900548159749]}<00:00, 6498.21it/s]
14 {'dev_rel': [61.59088948321973, 57.93232167491682, 59.70561177552898], 'dev_rel_ign': [57.34406433137485, 57.93232167491682, 57.63669205956919], 'dev_evi': [55.35692569621793, 46.57253939021895, 50.58620881257987]}6<00:00, 4025.70it/s]
15 {'dev_rel': [60.31613280923308, 58.52470989207173, 59.40691927512355], 'dev_rel_ign': [56.072949401895066, 58.52470989207173, 57.27260254279024], 'dev_evi': [53.9593552908199, 47.268262737876, 50.39267015706805]}:06<00:00, 6423.70it/s]
16 {'dev_rel': [61.254489267518586, 59.51472855635803, 60.37207770826474], 'dev_rel_ign': [57.03834038059053, 59.51472855635803, 58.25022671676506], 'dev_evi': [54.605149472956626, 48.49600982197667, 51.36958465414939]}00:00, 6436.23it/s]
17 {'dev_rel': [64.60317460317461, 56.147042116367764, 60.07901706247558], 'dev_rel_ign': [60.40731064187226, 56.147042116367764, 58.19931618994693], 'dev_evi': [57.886797402767755, 45.150399017802336, 50.731426929156484]}00, 6525.04it/s]
18 {'dev_rel': [64.11165666484816, 57.21820985149721, 60.469105098409145], 'dev_rel_ign': [59.904510300787784, 57.21820985149721, 58.53055388373816], 'dev_evi': [57.30137594318686, 46.22979332924084, 51.173589286219865]}0:00, 6352.03it/s]
19 {'dev_rel': [65.11649755730929, 56.24442100137953, 60.356163190664866], 'dev_rel_ign': [60.936349225737665, 56.24442100137953, 58.49645250661353], 'dev_evi': [58.566261098322926, 45.554532432985475, 51.2473743273962]}0:00, 6270.46it/s]
20 {'dev_rel': [64.18191603875134, 58.06216018826584, 60.968855182991774], 'dev_rel_ign': [60.05402154856541, 58.06216018826584, 59.04129591441223], 'dev_evi': [58.039563783920876, 46.828320032739924, 51.834654586636475]}:00, 6114.35it/s]
21 {'dev_rel': [66.9410569105691, 53.45289296437555, 59.441411361277794], 'dev_rel_ign': [62.75901538321808, 53.45289296437555, 57.73334212523012], 'dev_evi': [60.48252307245113, 42.57724575404133, 49.97448137140112]}5<00:00, 6513.17it/s]
22 {'dev_rel': [63.54697416644319, 57.68887446238741, 60.476393024245], 'dev_rel_ign': [59.362232128189106, 57.68887446238741, 58.513592170104324], 'dev_evi': [57.2203988891694, 46.378146101903006, 51.23191681735986]}5<00:00, 6509.73it/s]
23 {'dev_rel': [65.17940137572039, 56.901728475208955, 60.75993241194054], 'dev_rel_ign': [61.08456257938442, 56.901728475208955, 58.91900089156542], 'dev_evi': [59.01486988847584, 45.47779824022918, 51.36946723679648]}00:00, 6362.45it/s]
24 {'dev_rel': [63.201334621125646, 58.411101192891344, 60.71187584345479], 'dev_rel_ign': [58.97611583890357, 58.411101192891344, 58.69224873602414], 'dev_evi': [56.957143745723705, 46.84366687129118, 51.407719298245624]}00, 6495.24it/s]
25 {'dev_rel': [66.15457562825983, 56.609591820173655, 61.01101976561134], 'dev_rel_ign': [61.99957403960863, 56.609591820173655, 59.18211386051008], 'dev_evi': [59.68251832918544, 45.39083282177205, 51.56472468400407]}00:00, 6588.20it/s]
26 {'dev_rel': [64.741449327678, 58.21634342286781, 61.30575969919671], 'dev_rel_ign': [60.567218348236565, 58.21634342286781, 59.36851751125896], 'dev_evi': [58.37855090967125, 46.782279517086145, 51.94104450061058]}4<00:00, 6396.41it/s]
27 {'dev_rel': [65.33938327622928, 57.25878438691877, 61.032782631260275], 'dev_rel_ign': [61.18427868797648, 57.25878438691877, 59.156481271490335], 'dev_evi': [59.13857924938988, 45.866584816861064, 51.66383358783024]}0:00, 6237.82it/s]
28 {'dev_rel': [64.91514656502405, 58.045930374097225, 61.28866421043614], 'dev_rel_ign': [60.7791416650308, 58.045930374097225, 59.38110139119524], 'dev_evi': [58.817079463364294, 46.64927358297524, 52.031267830651615]}0:00, 6501.60it/s]
29 {'dev_rel': [65.59159601916697, 57.76190862614623, 61.42826321467098], 'dev_rel_ign': [61.45747309923878, 57.76190862614623, 59.55241327671139], 'dev_evi': [59.385643175268534, 46.383261714753424, 52.08524816176471]}00:00, 6405.33it/s]
dev_F1_ign: 59.55241327671139 saving model checkpoint into bert_lambda0.1_seed66/2025-02-23_15:38:37.155503/best.ckpt ...
saving model checkpoint into bert_lambda0.1_seed66/2025-02-23_15:38:37.155503/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-02-23_15:38:37.155503/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-02-23_15:38:37.155503/scores.csv ...
             precision     recall         F1
dev_rel      65.591596  57.761909  61.428263
dev_rel_ign  61.457473  57.761909  59.552413
dev_evi      59.385643  46.383262  52.085248
saving topk results into bert_lambda0.1_seed66/2025-02-23_15:38:37.155503/topk_results.json ...
经过时间：3小时 26分钟 16秒
