(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
use_graph: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: ['test', 'dev', 'train']
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [58.63952333664349, 28.75111579972409, 38.584263544786275], 'dev_rel_ign': [54.197213976911264, 28.75111579972409, 37.57110912946962], 'dev_evi': [51.59413804676139, 23.593206466134642, 32.37968196019237]}
1 {'dev_rel': [58.84918231374924, 39.42221861559685, 47.21547283506657], 'dev_rel_ign': [54.48821000202544, 39.42221861559685, 45.74670051648166], 'dev_evi': [52.710869010128526, 31.68099038264784, 39.575678180017256]}
2 {'dev_rel': [63.39943342776204, 45.40290513673618, 52.91280499337999], 'dev_rel_ign': [59.0724783843481, 45.40290513673618, 51.34342735837263], 'dev_evi': [56.344119237006716, 37.323511356660525, 44.902606394436404]}
3 {'dev_rel': [52.9060874885286, 56.13892720928345, 54.47458561360683], 'dev_rel_ign': [49.01895848247458, 56.13892720928345, 52.33790550313835], 'dev_evi': [46.908805853148685, 45.91774094536525, 46.407982834837]}
4 {'dev_rel': [50.38824359879356, 63.71825042603262, 56.27463627893643], 'dev_rel_ign': [46.140448623282396, 63.71825042603262, 53.52309258328379], 'dev_evi': [45.29435684272354, 51.28401882545529, 48.103452412370146]}
5 {'dev_rel': [59.653333333333336, 54.459141442830486, 56.938022313663936], 'dev_rel_ign': [55.19249747759872, 54.459141442830486, 54.82336709799262], 'dev_evi': [53.06757829192357, 44.470022508696545, 48.389880041192356]}
6 {'dev_rel': [57.483240449075204, 57.75379371906192, 57.6181994818653], 'dev_rel_ign': [53.46945986611027, 57.75379371906192, 55.52911025053273], 'dev_evi': [50.99345099345099, 47.00225086965418, 48.9165734973114]}
7 {'dev_rel': [61.82172258121626, 56.67451107684817, 59.1363251481795], 'dev_rel_ign': [57.76950939217712, 56.67451107684817, 57.21677177248702], 'dev_evi': [55.707535438945534, 45.835891139758544, 50.29187247418051]}
8 {'dev_rel': [57.77064076453079, 59.8474397468149, 58.790705089880035], 'dev_rel_ign': [53.48576354315292, 59.8474397468149, 56.488053245461955], 'dev_evi': [50.71981091534165, 48.301616533660734, 49.481186458442515]}
9 {'dev_rel': [62.519270880565884, 55.944169439259916, 59.04925053533191], 'dev_rel_ign': [58.39540964526333, 55.944169439259916, 57.14351439503949], 'dev_evi': [56.396534148827726, 45.283404951913234, 50.23266371580979]}
10 {'dev_rel': [60.405440082114445, 57.30747382942465, 58.81569084700591], 'dev_rel_ign': [56.19381086761256, 57.30747382942465, 56.745178775151025], 'dev_evi': [54.43661115838094, 45.820544301207285, 49.75834675851342]}
11 {'dev_rel': [61.860588391200636, 56.82057940436582, 59.23356738008629], 'dev_rel_ign': [57.57665088681539, 56.82057940436582, 57.196116640665615], 'dev_evi': [54.93491413554972, 45.98424391242071, 50.06265489682827]}
12 {'dev_rel': [59.9349593495935, 59.823095025561955, 59.87897494212727], 'dev_rel_ign': [55.72724817561113, 59.823095025561955, 57.702580031606765], 'dev_evi': [53.33819569120287, 48.634131368938, 50.877662421063896]}
13 {'dev_rel': [59.69322197237391, 60.3181043577051, 60.004036326942476], 'dev_rel_ign': [55.43420346702699, 60.3181043577051, 57.77312146161749], 'dev_evi': [53.56042355314023, 48.90525885001023, 51.12709575634409]}
14 {'dev_rel': [63.9945155393053, 56.8124644972815, 60.19000128960151], 'dev_rel_ign': [59.79791788140649, 56.8124644972815, 58.26697447258614], 'dev_evi': [57.8140104401624, 45.89216288111316, 51.16783117068302]}
15 {'dev_rel': [63.049255846917085, 57.75379371906192, 60.285460166871374], 'dev_rel_ign': [58.78865718922176, 57.75379371906192, 58.266630809042454], 'dev_evi': [56.36252296387018, 47.0841006752609, 51.30720775962986]}
16 {'dev_rel': [62.48595384216441, 58.66266331250507, 60.51397957475305], 'dev_rel_ign': [58.35332496079712, 58.66266331250507, 58.50758525997857], 'dev_evi': [56.57806702755307, 47.58543073460201, 51.69357303620551]}
17 {'dev_rel': [62.757346471933836, 57.88363223241094, 60.22204398666048], 'dev_rel_ign': [58.52439735594317, 57.88363223241094, 58.202251256279425], 'dev_evi': [56.18884540117417, 47.00225086965418, 51.18662952646239]}
18 {'dev_rel': [61.68879979954899, 59.936703724742344, 60.800131708923274], 'dev_rel_ign': [57.570992454378874, 59.936703724742344, 58.73003437353731], 'dev_evi': [55.43497286889551, 48.60343769183548, 51.79491372965901]}
19 {'dev_rel': [64.32378715331105, 57.77813844031486, 60.875512995896045], 'dev_rel_ign': [60.21559534533992, 57.77813844031486, 58.97169099588253], 'dev_evi': [58.15082050954601, 46.58788622877021, 51.73109148229146]}
20 {'dev_rel': [66.02698080942429, 56.398604235981495, 60.83417217383693], 'dev_rel_ign': [61.933148752466316, 56.398604235981495, 59.03644723186884], 'dev_evi': [59.92376803702696, 45.0378555350931, 51.425233644859816]}
21 {'dev_rel': [64.11933345278624, 58.078390002434475, 60.949542261017676], 'dev_rel_ign': [59.9299649225313, 58.078390002434475, 58.98965167027558], 'dev_evi': [57.67371790848033, 47.00225086965418, 51.794018997153245]}
22 {'dev_rel': [64.5322434150772, 57.65641483405015, 60.90087001242877], 'dev_rel_ign': [60.4156106838159, 57.65641483405015, 59.0037732775488], 'dev_evi': [58.46577800563958, 46.66973603437692, 51.90600819299045]}
23 {'dev_rel': [64.22618514203782, 58.159539073277614, 61.04250063878717], 'dev_rel_ign': [60.07201434279654, 58.159539073277614, 59.1003089181331], 'dev_evi': [58.12361331220285, 46.905054225496215, 51.91518274212269]}
24 {'dev_rel': [64.76018099547511, 58.070275095350155, 61.233046677790604], 'dev_rel_ign': [60.59900833694323, 58.070275095350155, 59.30769922680914], 'dev_evi': [58.540323095587766, 46.8999386126458, 52.077593797040535]}
25 {'dev_rel': [65.97339329211167, 57.14517568773837, 61.24277079619079], 'dev_rel_ign': [61.91275161292707, 57.14517568773837, 59.433506839023394], 'dev_evi': [59.84430101803181, 46.009821976672804, 52.02302108337913]}
26 {'dev_rel': [64.9995436707128, 57.79436825448349, 61.185567010309285], 'dev_rel_ign': [60.85136784314887, 57.79436825448349, 59.283485063837226], 'dev_evi': [58.85504066090099, 46.64927358297524, 52.046116089264316]}
27 {'dev_rel': [66.09119909926817, 57.161405501907005, 61.302815369218045], 'dev_rel_ign': [62.0058872350653, 57.161405501907005, 59.485175543464116], 'dev_evi': [60.145702446197035, 46.0354000409249, 52.15299913068676]}
28 {'dev_rel': [65.65019927704144, 57.47788687819525, 61.29283489096574], 'dev_rel_ign': [61.5600040850949, 57.47788687819525, 59.448952302347216], 'dev_evi': [59.679123200845105, 46.240024554941684, 52.10699256355566]}
29 {'dev_rel': [65.67343173431735, 57.77002353323054, 61.46872166817769], 'dev_rel_ign': [61.57976245577722, 57.77002353323054, 59.61408806495292], 'dev_evi': [59.669486523706475, 46.54696132596685, 52.29761186309165]}
dev_F1_ign: 59.61408806495292 saving model checkpoint into bert_lambda0.1_seed66/2025-01-06_03:04:30.895285/best.ckpt ...
saving model checkpoint into bert_lambda0.1_seed66/2025-01-06_03:04:30.895285/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-01-06_03:04:30.895285/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-01-06_03:04:30.895285/scores.csv ...
             precision     recall         F1
dev_rel      65.673432  57.770024  61.468722
dev_rel_ign  61.579762  57.770024  59.614088
dev_evi      59.669487  46.546961  52.297612
saving topk results into bert_lambda0.1_seed66/2025-01-06_03:04:30.895285/topk_results.json ...
经过时间：3小时 10分钟 25秒
