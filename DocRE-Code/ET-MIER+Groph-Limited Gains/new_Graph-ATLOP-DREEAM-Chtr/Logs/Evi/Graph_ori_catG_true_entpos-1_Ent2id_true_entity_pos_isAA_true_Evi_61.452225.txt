(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0.1_seed66 --save_path bert_lambda0.1_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0.1 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --ishas_enhance_evi --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.1_s_attn_lambda0_threeFalse_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: True
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: False
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: False
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [60.24237114907286, 33.48210662987909, 43.041936156895474], 'dev_rel_ign': [56.10896186958582, 33.48210662987909, 41.938248436461336], 'dev_evi': [54.02025630425796, 26.739308369142623, 35.771968245277854]}
1 {'dev_rel': [59.64550700741962, 35.22681165300657, 44.2936584868119], 'dev_rel_ign': [56.411397957240425, 35.22681165300657, 43.3704171954992], 'dev_evi': [53.119185192439524, 27.747084100675263, 36.452837796968986]}
2 {'dev_rel': [57.64119601328903, 47.86983689036761, 52.303054484195584], 'dev_rel_ign': [53.119930730918206, 47.86983689036761, 50.35841708741036], 'dev_evi': [51.311409932099586, 39.431143851033355, 44.593578247035]}
3 {'dev_rel': [54.552282400066765, 53.04714761015986, 53.78918785485066], 'dev_rel_ign': [50.576277293242335, 53.04714761015986, 51.782253860997706], 'dev_evi': [48.01874240758952, 42.46470227133211, 45.07126374372201]}
4 {'dev_rel': [47.002843381883594, 65.73074738294247, 54.81120584652862], 'dev_rel_ign': [42.84373237196087, 65.73074738294247, 51.87499964708003], 'dev_evi': [41.77918031477191, 53.50419480253734, 46.92028172805168]}
5 {'dev_rel': [59.45181255526083, 54.56463523492656, 56.903482418651876], 'dev_rel_ign': [55.376082460468936, 54.56463523492656, 54.96736429475303], 'dev_evi': [52.70064083002747, 44.17331696337221, 48.061670330893605]}
6 {'dev_rel': [60.58276725062567, 55.00284021747951, 57.658117476925696], 'dev_rel_ign': [56.551724082215046, 55.00284021747951, 55.766529379481064], 'dev_evi': [53.66981073146355, 43.95334561080417, 48.32803667351014]}
7 {'dev_rel': [61.79714823782621, 55.919824718006986, 58.7117662094232], 'dev_rel_ign': [57.55280982706974, 55.919824718006986, 56.72456712512568], 'dev_evi': [55.370957514267594, 44.6695314098629, 49.44787360552693]}
8 {'dev_rel': [60.27551550857737, 56.455408585571696, 58.3029541169076], 'dev_rel_ign': [55.98963327319099, 56.455408585571696, 56.22155625082355], 'dev_evi': [53.840034269628546, 45.00716185799058, 49.02895037476664]}
9 {'dev_rel': [62.41464080852226, 55.62768806297168, 58.82605337681284], 'dev_rel_ign': [58.142364572964546, 55.62768806297168, 56.857235182236884], 'dev_evi': [56.13978633028703, 44.62349089420913, 49.723536453286215]}
10 {'dev_rel': [61.2988617312274, 56.37425951472855, 58.733513696313835], 'dev_rel_ign': [57.1177160176792, 56.37425951472855, 56.74355267081855], 'dev_evi': [55.074094916525986, 45.058317986494785, 49.56529079091753]}
11 {'dev_rel': [63.05459957213283, 55.01095512456382, 58.7587761116408], 'dev_rel_ign': [58.70243287720687, 55.01095512456382, 56.79677577912747], 'dev_evi': [56.183584327531136, 44.08635154491508, 49.40522257574455]}
12 {'dev_rel': [59.99003901386237, 58.64643349833645, 59.31062782109151], 'dev_rel_ign': [55.81224784028947, 58.64643349833645, 57.19425111450447], 'dev_evi': [54.1411862494805, 46.64927358297524, 50.11678711769394]}
13 {'dev_rel': [58.480132711904574, 60.07465714517569, 59.26667200384277], 'dev_rel_ign': [54.08805026721869, 60.07465714517569, 56.924387115602336], 'dev_evi': [52.5453838894132, 48.41927562922038, 50.398019222065436]}
14 {'dev_rel': [61.962869345419676, 57.68887446238741, 59.74953773743486], 'dev_rel_ign': [57.75002414778776, 57.68887446238741, 57.71943310914294], 'dev_evi': [55.118110236220474, 46.193984039287905, 50.26300409117476]}
15 {'dev_rel': [59.74279667914699, 59.56341799886391, 59.65297248973953], 'dev_rel_ign': [55.38919450221954, 59.56341799886391, 57.40051788253151], 'dev_evi': [53.53860294117647, 47.67751176590956, 50.438359129775954]}
16 {'dev_rel': [63.70330459770115, 57.567150856122694, 60.47998635917984], 'dev_rel_ign': [59.547638050893084, 57.567150856122694, 58.540648790704516], 'dev_evi': [57.42410770989458, 46.255371393492936, 51.23817079390264]}
17 {'dev_rel': [65.39493865030674, 55.35989612918932, 59.96044825313118], 'dev_rel_ign': [61.14101177487512, 55.35989612918932, 58.10701602219087], 'dev_evi': [59.42039009544888, 43.94822999795375, 50.52637769805328]}
18 {'dev_rel': [60.39344262295082, 59.7906353972247, 60.09052726012315], 'dev_rel_ign': [56.06074378825067, 59.7906353972247, 57.86564675374643], 'dev_evi': [54.28190409926364, 47.89236750562718, 50.887348824568555]}
19 {'dev_rel': [63.166311300639656, 57.696989369471716, 60.307901098435046], 'dev_rel_ign': [58.95049499113812, 57.696989369471716, 58.31700703144097], 'dev_evi': [57.20374022008778, 46.004706363822386, 50.99662593212169]}
20 {'dev_rel': [63.826526012081864, 57.44542724985799, 60.46809601093363], 'dev_rel_ign': [59.686495116874504, 57.44542724985799, 58.54452217219366], 'dev_evi': [57.68605784855379, 45.401064047472886, 50.81155354535826]}
21 {'dev_rel': [64.18072945019053, 57.404852714436416, 60.603983722424495], 'dev_rel_ign': [59.9756690389541, 57.404852714436416, 58.662108435064894], 'dev_evi': [57.82790847566871, 45.897278493963576, 51.17645381171035]}
22 {'dev_rel': [65.1779935275081, 57.20198003732857, 60.93007174345232], 'dev_rel_ign': [61.00641948539406, 57.20198003732857, 59.04297839480683], 'dev_evi': [58.801794668778044, 45.59034172293841, 51.36007376671278]}
23 {'dev_rel': [64.81818181818181, 57.859287511157994, 61.14136260343868], 'dev_rel_ign': [60.734577860455985, 57.859287511157994, 59.2620771957407], 'dev_evi': [58.72417825126672, 46.2451401677921, 51.74288821475588]}
24 {'dev_rel': [65.94574084613926, 56.414834050150134, 60.80909687294992], 'dev_rel_ign': [61.82475535748112, 56.414834050150134, 58.99603222841233], 'dev_evi': [59.92068918364556, 44.83323102107632, 51.29045473166733]}
25 {'dev_rel': [65.07484617503903, 57.50223159944818, 61.05462691711183], 'dev_rel_ign': [60.94680626314767, 57.50223159944818, 59.17443370127874], 'dev_evi': [59.19570690340533, 45.70800081849806, 51.58478147912939]}
26 {'dev_rel': [65.9606656580938, 56.609591820173655, 60.92842482204463], 'dev_rel_ign': [61.8361072173899, 56.609591820173655, 59.107537340208395], 'dev_evi': [59.79423587926688, 44.89461837528136, 51.284149013878746]}
27 {'dev_rel': [65.19214818910699, 57.404852714436416, 61.051178044360064], 'dev_rel_ign': [61.09795029241122, 57.404852714436416, 59.19385446920027], 'dev_evi': [59.2007992007992, 45.47268262737876, 51.436507247634765]}
28 {'dev_rel': [65.72617946345976, 57.65641483405015, 61.427398089309634], 'dev_rel_ign': [61.59427795004221, 57.65641483405015, 59.560328883307825], 'dev_evi': [59.55048686141124, 45.67730714139554, 51.699380464362235]}
29 {'dev_rel': [65.5626092556813, 57.826827882820744, 61.45222490513971], 'dev_rel_ign': [61.43225135349588, 57.826827882820744, 59.57504029413981], 'dev_evi': [59.55877466941325, 45.8512379783098, 51.81374107581581]}
dev_F1_ign: 59.57504029413981 saving model checkpoint into bert_lambda0.1_seed66/2025-03-07_17:17:11.203456/best.ckpt ...
saving model checkpoint into bert_lambda0.1_seed66/2025-03-07_17:17:11.203456/last.ckpt ...
saving official predictions into bert_lambda0.1_seed66/2025-03-07_17:17:11.203456/results.json ...
saving evaluations into bert_lambda0.1_seed66/2025-03-07_17:17:11.203456/scores.csv ...
             precision     recall         F1
dev_rel      65.562609  57.826828  61.452225
dev_rel_ign  61.432251  57.826828  59.575040
dev_evi      59.558775  45.851238  51.813741
saving topk results into bert_lambda0.1_seed66/2025-03-07_17:17:11.203456/topk_results.json ...
经过时间：2小时 51分钟 59秒
