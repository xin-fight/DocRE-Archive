(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: False
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.bias', 'cls.predictions.bias', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 129621608
trainable_num/total_num: 129.62M / 129.62M
Feature file: ./feature_file/graph_True_train_annotated_feature.pkl
Feature loaded from ./feature_file/graph_True_train_annotated_feature.pkl
Feature file: ./feature_file/graph_True_dev_feature.pkl
Feature loaded from ./feature_file/graph_True_dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [48.11085219707058, 46.91227785441857, 47.504005916430415], 'dev_rel_ign': [43.84400608498243, 46.91227785441857, 45.326276185633105], 'dev_evi': [45.00101605364763, 22.65704931450788, 30.139503232391974]}00:00, 7049.25it/s]
1 {'dev_rel': [60.9967173977917, 33.17374016067516, 42.975032851511166], 'dev_rel_ign': [57.98778518484766, 33.17374016067516, 42.20358777289067], 'dev_evi': [56.82868525896414, 18.242275424595867, 27.618789451264377]}<00:00, 7306.39it/s]
2 {'dev_rel': [51.343260669327606, 54.28061348697557, 52.77109384245197], 'dev_rel_ign': [47.047030283980426, 54.28061348697557, 50.40562617497214], 'dev_evi': [46.81688401882862, 31.036423163494987, 37.3273448795644]}<00:00, 7145.51it/s]
3 {'dev_rel': [61.64562472790597, 45.96283372555384, 52.661429036307005], 'dev_rel_ign': [57.613663630486336, 45.96283372555384, 51.13297532480434], 'dev_evi': [56.8818123530669, 27.230407202782892, 36.82972393274752]}<00:00, 7112.58it/s]
4 {'dev_rel': [54.763196651422376, 57.331818550677596, 56.01807802093245], 'dev_rel_ign': [50.315000808517794, 57.331818550677596, 53.59471861598904], 'dev_evi': [50.6067269321606, 31.788418252506652, 39.04860652904767]}0:00, 7208.34it/s]
5 {'dev_rel': [60.49516580825879, 54.32930292948146, 57.246686618212905], 'dev_rel_ign': [56.319312562374556, 54.32930292948146, 55.30641263571175], 'dev_evi': [56.1047061047061, 30.371393492940452, 39.40922668436774]}<00:00, 7200.34it/s]
6 {'dev_rel': [58.55359765051396, 51.773107197922585, 54.95499375511436], 'dev_rel_ign': [54.59481192982625, 51.773107197922585, 53.146532783039845], 'dev_evi': [53.02650429799427, 30.29465930018416, 38.55970829535096]}00:00, 1692.88it/s]
7 {'dev_rel': [58.23215152986887, 58.37864156455409, 58.30530453458687], 'dev_rel_ign': [54.05164732497627, 58.37864156455409, 56.131880053406476], 'dev_evi': [53.13518238893745, 34.202987517904646, 41.61712987457596]}<00:00, 7111.50it/s]
8 {'dev_rel': [60.57233704292527, 55.65203278422462, 58.00803552548107], 'dev_rel_ign': [56.23958429934361, 55.65203278422462, 55.94426590261277], 'dev_evi': [55.55857569991846, 31.36893799877225, 40.09808729769495]}58<00:00, 7152.08it/s]
9 {'dev_rel': [66.03753800985635, 51.107684817008845, 57.621225983531566], 'dev_rel_ign': [62.19213252924929, 51.107684817008845, 56.10769693809201], 'dev_evi': [59.908952959028824, 30.29465930018416, 40.24054632555295]}0:00, 7166.59it/s]
10 {'dev_rel': [61.39850160542276, 55.863020368416784, 58.50010622477162], 'dev_rel_ign': [57.20783067311862, 55.863020368416784, 56.527428257375], 'dev_evi': [52.889066241021546, 33.90116635972989, 41.31803728411996]}<00:00, 7256.00it/s]
11 {'dev_rel': [63.86027345944933, 55.33555140793638, 59.2930742141646], 'dev_rel_ign': [59.764362360792035, 55.33555140793638, 57.46475105833924], 'dev_evi': [57.36875395319419, 32.47902598731328, 41.47640045729218]}8<00:00, 7051.37it/s]
12 {'dev_rel': [62.79498525073747, 55.27874705834618, 58.797634974752924], 'dev_rel_ign': [58.515777512061085, 55.27874705834618, 56.85122155434319], 'dev_evi': [57.07805546045874, 34.11602209944751, 42.7061987704918]}<00:00, 7070.48it/s]
13 {'dev_rel': [60.38928210313448, 58.159539073277614, 59.253441362490186], 'dev_rel_ign': [56.09414396554203, 58.159539073277614, 57.10817316300503], 'dev_evi': [54.707525468287876, 34.06486597094332, 41.986128625472894]}00, 6993.50it/s]
14 {'dev_rel': [64.54413892908828, 54.288728394059895, 58.97390691114246], 'dev_rel_ign': [60.45836016735705, 54.288728394059895, 57.207682311157484], 'dev_evi': [58.33107068512987, 32.97012482095355, 42.128313233323524]}:00, 7201.69it/s]
15 {'dev_rel': [64.08517052948936, 55.197597987503045, 59.310284692854346], 'dev_rel_ign': [59.71679165199536, 55.197597987503045, 57.36833253086938], 'dev_evi': [56.732716864817256, 32.95477798240229, 41.69174513801249]}:00, 7062.69it/s]
16 {'dev_rel': [63.68561197318887, 56.284995536801105, 59.757043163608174], 'dev_rel_ign': [59.44005736904927, 56.284995536801105, 57.81951754985989], 'dev_evi': [58.092407457443926, 32.995702885205645, 42.08671821474014]}00, 7150.11it/s]
17 {'dev_rel': [63.37353671514722, 57.98912602450702, 60.56188821560235], 'dev_rel_ign': [59.121053094010634, 57.98912602450702, 58.54961924531891], 'dev_evi': [57.82772175696462, 34.61735215878862, 43.308800000000005]}00:00, 7255.33it/s]
18 {'dev_rel': [64.76871632918447, 56.58524709892072, 60.40105678028499], 'dev_rel_ign': [60.59630161999138, 56.58524709892072, 58.52212635750143], 'dev_evi': [58.87492199340287, 33.78350726417025, 42.93190313668129]}9<00:00, 5999.61it/s]
19 {'dev_rel': [65.22563519150549, 55.83056074007953, 60.1635258624459], 'dev_rel_ign': [60.99532107507941, 55.83056074007953, 58.298776353871276], 'dev_evi': [59.30189032378813, 32.41763863310825, 41.91969306079248]}1<00:00, 7129.45it/s]
20 {'dev_rel': [66.0774654689462, 55.51407936379128, 60.33692009172693], 'dev_rel_ign': [61.85096669362268, 55.51407936379128, 58.511449347147085], 'dev_evi': [59.937975754158444, 32.62737875997544, 42.2538010533638]}0<00:00, 6975.12it/s]
21 {'dev_rel': [66.5675782798256, 54.51594579242067, 59.94200312290876], 'dev_rel_ign': [62.36475174303988, 54.51594579242067, 58.17681613937741], 'dev_evi': [59.54502369668246, 32.13627992633518, 41.74363745099342]}55<00:00, 7018.29it/s]
22 {'dev_rel': [66.3234579893152, 55.4085855716952, 60.37669113095765], 'dev_rel_ign': [62.12584655655905, 55.4085855716952, 58.575265525371236], 'dev_evi': [59.75053523224425, 32.837118886842646, 42.38222574362022]}55<00:00, 7216.39it/s]
23 {'dev_rel': [66.81733320231895, 55.18136817333441, 60.44444444444444], 'dev_rel_ign': [62.57757085264011, 55.18136817333441, 58.647199188008784], 'dev_evi': [60.11017190616392, 32.37671373030489, 42.08531435980983]}<00:00, 7089.81it/s]
24 {'dev_rel': [68.34099030117406, 54.32118802239715, 60.529885161407], 'dev_rel_ign': [64.28653683716857, 54.32118802239715, 58.88522116034763], 'dev_evi': [60.67695848115831, 32.37159811745447, 42.21903459318811]}:59<00:00, 6962.84it/s]
25 {'dev_rel': [66.89313792099388, 55.92793962509129, 60.92106426235304], 'dev_rel_ign': [62.72131140686196, 55.92793962509129, 59.1301451473103], 'dev_evi': [59.10146480886031, 33.8500102312257, 43.04579755399428]}:02<00:00, 7149.97it/s]
26 {'dev_rel': [67.09258895223118, 55.39235575752658, 60.68364670845002], 'dev_rel_ign': [62.9441061837918, 55.39235575752658, 58.927270012535914], 'dev_evi': [59.29728294539339, 34.27460609781052, 43.44020488216034]}0<00:00, 6946.33it/s]
27 {'dev_rel': [66.9146058732612, 56.21196137304227, 61.0981256890849], 'dev_rel_ign': [62.735284449205444, 56.21196137304227, 59.294746369418995], 'dev_evi': [60.04549590536852, 33.75792919991815, 43.21828541489292]}0<00:00, 3679.68it/s]
28 {'dev_rel': [66.88972941518766, 55.96851416051286, 60.943712998144385], 'dev_rel_ign': [62.700753782693376, 55.96851416051286, 59.14367024899825], 'dev_evi': [59.994536016756214, 33.70165745856354, 43.158963608372375]}:00, 7163.62it/s]
29 {'dev_rel': [67.20639875146313, 55.91170981092266, 61.04097452934661], 'dev_rel_ign': [63.01023207942542, 55.91170981092266, 59.24911341242836], 'dev_evi': [59.9525850278107, 33.63515449150808, 43.093560543994755]}9<00:00, 7246.66it/s]
saving model checkpoint into bert_lambda0_seed66/2025-02-26_14:48:02.622439/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-02-26_14:48:02.622439/results.json ...
saving evaluations into bert_lambda0_seed66/2025-02-26_14:48:02.622439/scores.csv ...
             precision     recall         F1
dev_rel      66.914606  56.211961  61.098126
dev_rel_ign  62.735284  56.211961  59.294746
dev_evi      60.045496  33.757929  43.218285
saving topk results into bert_lambda0_seed66/2025-02-26_14:48:02.622439/topk_results.json ...
经过时间：2小时 57分钟 38秒
