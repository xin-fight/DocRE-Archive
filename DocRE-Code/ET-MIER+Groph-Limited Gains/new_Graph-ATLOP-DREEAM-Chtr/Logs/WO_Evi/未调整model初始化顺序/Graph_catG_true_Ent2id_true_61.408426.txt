(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Saving to ./feature_file/dev_feature.pkl
Save  ./feature_file/dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [52.078774617067836, 42.4896534934675, 46.798051570809314], 'dev_rel_ign': [47.924772970249926, 42.4896534934675, 45.04385144944031], 'dev_evi': [52.702702702702695, 13.766114180478823, 21.83012898515454]}00:00, 6339.57it/s]
1 {'dev_rel': [61.659551760939166, 37.507100543698776, 46.64211110550481], 'dev_rel_ign': [57.76014100858298, 37.507100543698776, 45.48080496354526], 'dev_evi': [57.69564462953323, 17.009412727644772, 26.273161866382207]}:00, 6483.38it/s]
2 {'dev_rel': [55.6014498862008, 53.525927128134384, 54.5439510460597], 'dev_rel_ign': [51.2856085356219, 53.525927128134384, 52.38182472597778], 'dev_evi': [52.820172528201724, 24.432166973603437, 33.410283315844694]}<00:00, 7050.28it/s]
3 {'dev_rel': [64.13763160751112, 47.95098596121075, 54.87555720653789], 'dev_rel_ign': [60.393191008878944, 47.95098596121075, 53.45765938152709], 'dev_evi': [60.37786056412986, 23.2146511152036, 33.535323677209576]}1<00:00, 6960.82it/s]
4 {'dev_rel': [58.43621399176955, 56.46352349265601, 57.43293437886916], 'dev_rel_ign': [53.87268146717058, 56.46352349265601, 55.13768425770117], 'dev_evi': [54.18569254185692, 25.49621444649069, 34.676128852709944]}1<00:00, 7040.38it/s]
5 {'dev_rel': [62.232669616519175, 54.78373772620303, 58.271114755513366], 'dev_rel_ign': [58.22371769325613, 54.78373772620303, 56.45137071199963], 'dev_evi': [58.562637872982705, 25.803151217515857, 35.82259152728951]}0:00, 6998.63it/s]
6 {'dev_rel': [57.509771077610274, 58.508480077903116, 58.004827031375704], 'dev_rel_ign': [53.589475471694136, 58.508480077903116, 55.941051603454675], 'dev_evi': [53.18238036342879, 28.596275833844892, 37.19351941182341]}0, 7033.46it/s]
7 {'dev_rel': [60.41343669250646, 56.91795828937759, 58.613629716291314], 'dev_rel_ign': [56.34083779201973, 56.91795828937759, 56.62792765570431], 'dev_evi': [51.82204539289267, 29.31757724575404, 37.44894958669585]}1<00:00, 6510.34it/s]
8 {'dev_rel': [58.68392664509169, 57.38862290026779, 58.02904734553213], 'dev_rel_ign': [54.41311110198397, 57.38862290026779, 55.86127159350212], 'dev_evi': [50.66079295154186, 31.179660323306734, 38.601602330662786]}<00:00, 6940.60it/s]
9 {'dev_rel': [64.97074283447387, 53.160756309340265, 58.4754083727573], 'dev_rel_ign': [61.01975492658674, 53.160756309340265, 56.819789762637896], 'dev_evi': [58.31515529240677, 28.719050542254966, 38.485004284490145]}0:00, 6944.22it/s]
10 {'dev_rel': [64.95400274026228, 53.858638318591254, 58.88824808127413], 'dev_rel_ign': [60.83342441120701, 53.858638318591254, 57.13395199393013], 'dev_evi': [57.69267962479451, 30.51974626560262, 39.9210411857205]}<00:00, 4879.24it/s]
11 {'dev_rel': [61.908114768526666, 57.08025643106387, 59.39624234747731], 'dev_rel_ign': [57.76324772346712, 57.08025643106387, 57.419721152186476], 'dev_evi': [55.2683013503909, 31.82422754245959, 40.390858330087006]}00:00, 6946.71it/s]
12 {'dev_rel': [61.16306750552627, 58.37864156455409, 59.73842640647705], 'dev_rel_ign': [56.92191620433618, 58.37864156455409, 57.64107663592108], 'dev_evi': [54.06597133892988, 32.61714753427461, 40.68791678631824]}4<00:00, 6851.35it/s]
13 {'dev_rel': [60.78797656449011, 58.0946198166031, 59.41078838174274], 'dev_rel_ign': [56.46271324930451, 58.0946198166031, 57.267043012341375], 'dev_evi': [53.66689513365319, 32.04419889502763, 40.128122998078155]}0<00:00, 6858.78it/s]
14 {'dev_rel': [60.818074920208296, 58.76004219751684, 59.77134838416773], 'dev_rel_ign': [56.657065821186414, 58.76004219751684, 57.68939519609022], 'dev_evi': [52.595550484883056, 33.01616533660733, 40.566956849681006]}:00, 7015.28it/s]
15 {'dev_rel': [62.69980678025645, 57.93232167491682, 60.2218566788983], 'dev_rel_ign': [58.57393673568676, 57.93232167491682, 58.25136247666496], 'dev_evi': [56.54533545429026, 30.913648455084918, 39.97354059864396]}0<00:00, 6948.99it/s]
16 {'dev_rel': [64.13548210871348, 57.161405501907005, 60.44795331674248], 'dev_rel_ign': [59.892067956529814, 57.161405501907005, 58.49488582714443], 'dev_evi': [57.8245875664088, 31.73726212400246, 40.981603197146356]}0:00, 6675.97it/s]
17 {'dev_rel': [64.67624556820303, 56.252535908463855, 60.17099952259017], 'dev_rel_ign': [60.59943796378454, 56.252535908463855, 58.345134397427636], 'dev_evi': [58.11250123140578, 30.177000204624516, 39.72524327418432]}:00, 6830.29it/s]
18 {'dev_rel': [64.94020152556737, 55.96039925342855, 60.11681631941417], 'dev_rel_ign': [60.83526187583078, 55.96039925342855, 58.29609611080868], 'dev_evi': [58.08418568056648, 30.212809494577453, 39.749629829048324]}00:00, 7070.93it/s]
19 {'dev_rel': [64.79625292740046, 56.13081230219914, 60.153056787546745], 'dev_rel_ign': [60.554214274636074, 56.13081230219914, 58.25867011854493], 'dev_evi': [57.90840869732538, 30.79087374667485, 40.204395163983705]}0:00, 6976.11it/s]
20 {'dev_rel': [64.2988929889299, 56.56090237766777, 60.18218710875103], 'dev_rel_ign': [60.15238873542794, 56.56090237766777, 58.30138717879601], 'dev_evi': [57.34632683658171, 31.30755064456722, 40.50297816015883]}57<00:00, 7017.42it/s]
21 {'dev_rel': [65.30935519940365, 56.87738375395601, 60.80242897419216], 'dev_rel_ign': [61.072772834511944, 56.87738375395601, 58.90046504213521], 'dev_evi': [58.205178119525016, 30.59136484550849, 40.10462074978204]}00:00, 7015.59it/s]
22 {'dev_rel': [65.49580939824843, 56.439178771403064, 60.63115683026763], 'dev_rel_ign': [61.30939803452017, 56.439178771403064, 58.773569412064894], 'dev_evi': [58.4831675592961, 31.28197258031512, 40.76123183575523]}00:00, 7027.20it/s]
23 {'dev_rel': [66.16214170844763, 56.75566014769131, 61.09897789813925], 'dev_rel_ign': [62.05982174155725, 56.75566014769131, 59.289346734684244], 'dev_evi': [59.15439429928742, 31.849805606711683, 41.40591228011837]}00:00, 6174.06it/s]
24 {'dev_rel': [67.45550362931291, 55.0515296599854, 60.625558534405734], 'dev_rel_ign': [63.29071325337515, 55.0515296599854, 58.88430863053128], 'dev_evi': [60.78509119746233, 31.36893799877225, 41.3821028478877]}:56<00:00, 7072.39it/s]
25 {'dev_rel': [65.44212663836072, 57.53469122778544, 61.23418404802005], 'dev_rel_ign': [61.278312068178394, 57.53469122778544, 59.34752368846637], 'dev_evi': [58.65544664324024, 32.448332310210766, 41.78249127198471]}00:00, 7085.91it/s]
26 {'dev_rel': [66.62213740458014, 56.658281262679544, 61.23755646186906], 'dev_rel_ign': [62.5521892061319, 56.658281262679544, 59.459534312711185], 'dev_evi': [59.647451167222485, 32.02373644362594, 41.67360117165397]}0:00, 7070.39it/s]
27 {'dev_rel': [66.89111196614083, 56.43106386431875, 61.21748316387164], 'dev_rel_ign': [62.797232962821845, 56.43106386431875, 59.44418830313823], 'dev_evi': [60.04773269689737, 32.17720482913853, 41.901209073044]}01<00:00, 6912.07it/s]
28 {'dev_rel': [66.70155075635049, 56.89361356812464, 61.408426031356754], 'dev_rel_ign': [62.56284087863639, 56.89361356812464, 59.59370063606843], 'dev_evi': [60.04570557988954, 32.25905463474524, 41.97004991680532]}<00:00, 6806.28it/s]
29 {'dev_rel': [66.69526260604327, 56.78000486894425, 61.33952835977908], 'dev_rel_ign': [62.58299415015743, 56.78000486894425, 59.54043952917751], 'dev_evi': [60.036183584079225, 32.25393902189482, 41.963394342762065]}00:00, 6994.99it/s]
saving model checkpoint into bert_lambda0_seed66/2025-02-22_13:48:38.215047/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-02-22_13:48:38.215047/results.json ...
saving evaluations into bert_lambda0_seed66/2025-02-22_13:48:38.215047/scores.csv ...
             precision     recall         F1
dev_rel      66.701551  56.893614  61.408426
dev_rel_ign  62.562841  56.893614  59.593701
dev_evi      60.045706  32.259055  41.970050
saving topk results into bert_lambda0_seed66/2025-02-22_13:48:38.215047/topk_results.json ...
经过时间：2小时 59分钟 39秒
