(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: False
cat_htrs_htrsnew: False
**********
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 129621608
trainable_num/total_num: 129.62M / 129.62M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [58.80287577328206, 28.540128215531936, 38.42875874125874], 'dev_rel_ign': [54.046997288237606, 28.540128215531936, 37.35468991956629], 'dev_evi': [58.104738154613464, 10.72744014732965, 18.111154294597746]}
1 {'dev_rel': [63.855030066634164, 31.883469934269254, 42.53085083351375], 'dev_rel_ign': [60.093306908140484, 31.883469934269254, 41.662324117734634], 'dev_evi': [57.478005865102645, 17.04522201759771, 26.293154468336947]}
2 {'dev_rel': [57.499739773082126, 44.8267467337499, 50.37847697218422], 'dev_rel_ign': [53.14436532804181, 44.8267467337499, 48.63247858988204], 'dev_evi': [52.01309328968904, 24.38612645794966, 33.20447184202278]}
3 {'dev_rel': [55.05782841360263, 51.76499229083827, 53.36065916600443], 'dev_rel_ign': [51.28181132926477, 51.76499229083827, 51.52226900518312], 'dev_evi': [50.71939018580276, 27.230407202782892, 35.435875245481476]}
4 {'dev_rel': [58.70628402694472, 51.62703887040493, 54.93955094991364], 'dev_rel_ign': [54.191831247628386, 51.62703887040493, 52.87835289034991], 'dev_evi': [51.558178130186235, 28.606507059545734, 36.7967361979338]}
5 {'dev_rel': [61.147621383030895, 50.58833076361275, 55.36903810285105], 'dev_rel_ign': [56.767081361310765, 50.58833076361275, 53.49989966130831], 'dev_evi': [52.42560865644725, 29.74217311233886, 37.95286898622626]}
6 {'dev_rel': [52.839771101573675, 59.94481863182667, 56.16849788997453], 'dev_rel_ign': [48.88354779897384, 59.94481863182667, 53.85205168457588], 'dev_evi': [43.57245426734095, 35.70186208307755, 39.2464501616758]}
7 {'dev_rel': [62.56674645553305, 55.148908544997155, 58.62411041621738], 'dev_rel_ign': [58.28460033006607, 55.148908544997155, 56.67341379212418], 'dev_evi': [52.90453074433656, 33.45099242889298, 40.98658643600351]}
8 {'dev_rel': [59.94189524053661, 56.9260731964619, 58.39507200532756], 'dev_rel_ign': [55.46266382722529, 56.9260731964619, 56.1848410136321], 'dev_evi': [50.573536932856, 35.410272150603646, 41.654881901609755]}
9 {'dev_rel': [63.68704526126807, 54.694473748275584, 58.84920981402253], 'dev_rel_ign': [59.54736835837119, 54.694473748275584, 57.01784767117891], 'dev_evi': [53.95150034891836, 31.640065479844488, 39.887785373403844]}
10 {'dev_rel': [62.13538800220143, 54.97038058914225, 58.33369214208825], 'dev_rel_ign': [58.0530433309084, 54.97038058914225, 56.469672844371765], 'dev_evi': [52.68593387238813, 33.6658481686106, 41.08118230906083]}
11 {'dev_rel': [64.38120702826585, 54.71070356244421, 59.15332309717044], 'dev_rel_ign': [60.064239764385185, 54.71070356244421, 57.26261710441971], 'dev_evi': [54.29598170532506, 34.00859422958871, 41.82184197282336]}
12 {'dev_rel': [64.1321693419694, 55.441045200032455, 59.47075208913648], 'dev_rel_ign': [59.94758903569435, 55.441045200032455, 57.60631478783645], 'dev_evi': [55.423575022684155, 34.37180274196849, 42.42998326544789]}
13 {'dev_rel': [60.49088119993182, 57.59961048445995, 59.00985160244419], 'dev_rel_ign': [56.14831625411624, 57.59961048445995, 56.86470493705368], 'dev_evi': [51.64466323562318, 35.42050337630448, 42.02093764223942]}
14 {'dev_rel': [64.1247996983693, 55.20571289458736, 59.33193790336647], 'dev_rel_ign': [59.83113450149749, 55.20571289458736, 57.425433819034325], 'dev_evi': [55.286380286380286, 33.97278493963577, 42.08491761723701]}
15 {'dev_rel': [61.818501582835026, 57.047796802726616, 59.3374129563199], 'dev_rel_ign': [57.45222924306495, 57.047796802726616, 57.249298762801494], 'dev_evi': [52.75836431226766, 36.30038878657663, 43.00866719195103]}
16 {'dev_rel': [61.54957097952596, 58.792501825854096, 60.13945380592679], 'dev_rel_ign': [57.34213001193014, 58.792501825854096, 58.05825928192975], 'dev_evi': [51.773557864564665, 36.96030284428075, 43.130465928424314]}
17 {'dev_rel': [63.97578203834511, 56.59336200600503, 60.058560110230786], 'dev_rel_ign': [59.80141257057896, 56.59336200600503, 58.15317744956726], 'dev_evi': [54.33132482979889, 35.51770002046245, 42.95480558047453]}
18 {'dev_rel': [61.976535068938944, 58.72758256917958, 60.308333333333344], 'dev_rel_ign': [57.726363841067915, 58.72758256917958, 58.222669190650976], 'dev_evi': [52.542746018932995, 36.62778800900348, 43.165033911077614]}
19 {'dev_rel': [65.43778801843318, 55.311206686683434, 59.94986586921149], 'dev_rel_ign': [61.190168109971786, 55.311206686683434, 58.10235358047851], 'dev_evi': [55.88114585898383, 34.82709228565582, 42.91071822507958]}
20 {'dev_rel': [69.09682156718766, 53.45289296437555, 60.27635431918008], 'dev_rel_ign': [64.99940588689628, 53.45289296437555, 58.663382970434675], 'dev_evi': [59.06679852557764, 33.60957642725598, 42.84177235825372]}
21 {'dev_rel': [67.67294310274254, 53.66388054856772, 59.85969676397376], 'dev_rel_ign': [63.53457224571791, 53.66388054856772, 58.183561547235605], 'dev_evi': [58.35248364857698, 33.773276038469405, 42.78400622124295]}
22 {'dev_rel': [67.6378981211695, 54.62955449160107, 60.44173101095349], 'dev_rel_ign': [63.526214399811785, 54.62955449160107, 58.742942875502166], 'dev_evi': [58.160315374507235, 33.96255371393493, 42.883441526983816]}
23 {'dev_rel': [66.4769987462629, 55.9360545321756, 60.752688172043015], 'dev_rel_ign': [62.28707815744051, 55.9360545321756, 58.94097578367579], 'dev_evi': [57.73487559291004, 35.492121956210354, 43.96008236971329]}
24 {'dev_rel': [67.0103092783505, 55.91170981092266, 60.95996460959965], 'dev_rel_ign': [62.88434176290147, 55.91170981092266, 59.19339947276415], 'dev_evi': [57.19324766943814, 34.83732351135666, 43.29995231282784]}
25 {'dev_rel': [66.25865831672834, 56.66639616976386, 61.08826874289214], 'dev_rel_ign': [62.12185762449738, 56.66639616976386, 59.268853316900916], 'dev_evi': [58.45969330934635, 34.90894209126253, 43.71416674674097]}
26 {'dev_rel': [67.24796708141471, 55.700722226730505, 60.93209054593874], 'dev_rel_ign': [63.138162903144604, 55.700722226730505, 59.18670929857138], 'dev_evi': [58.96393210749646, 34.12113771229793, 43.22747893713545]}
27 {'dev_rel': [66.98991466252909, 56.05777813844032, 61.0382151535233], 'dev_rel_ign': [62.814070283139536, 56.05777813844032, 59.24392129272881], 'dev_evi': [59.15641476274165, 34.43830570902394, 43.53336782203828]}
28 {'dev_rel': [67.11102461807921, 55.96851416051286, 61.03539823008849], 'dev_rel_ign': [62.942659727066484, 55.96851416051286, 59.25106997203113], 'dev_evi': [59.10931174089069, 34.35645590341723, 43.455192494338405]}
29 {'dev_rel': [67.1461897356143, 56.05777813844032, 61.10300296315951], 'dev_rel_ign': [62.9751341187697, 56.05777813844032, 59.31546208060926], 'dev_evi': [59.07695007458103, 34.44342132187436, 43.51591533365649]}
saving model checkpoint into bert_lambda0_seed66/2025-01-07_02:33:46.575344/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-01-07_02:33:46.575344/results.json ...
saving evaluations into bert_lambda0_seed66/2025-01-07_02:33:46.575344/scores.csv ...
             precision     recall         F1
dev_rel      67.146190  56.057778  61.103003
dev_rel_ign  62.975134  56.057778  59.315462
dev_evi      59.076950  34.443421  43.515915
saving topk results into bert_lambda0_seed66/2025-01-07_02:33:46.575344/topk_results.json ...
经过时间：2小时 54分钟 23秒
