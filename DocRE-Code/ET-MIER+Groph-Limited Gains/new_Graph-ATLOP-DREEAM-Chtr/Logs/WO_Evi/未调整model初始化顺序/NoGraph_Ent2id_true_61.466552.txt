(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten 
####################
**********
save_path: ./Save/use_graphFalse_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: False
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 115448936
trainable_num/total_num: 115.45M / 115.45M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [48.54430379746835, 43.56893613568125, 45.92225120814267], 'dev_rel_ign': [44.82257121890385, 43.56893613568125, 44.186863677738735], 'dev_evi': [48.00389483933788, 15.131982811540823, 23.010501750291716]}
1 {'dev_rel': [64.23161083992593, 30.966485433741788, 41.78712220762155], 'dev_rel_ign': [61.286208669545985, 30.966485433741788, 41.143914690012714], 'dev_evi': [61.53846153846154, 14.200941272764478, 23.076603350097677]}
2 {'dev_rel': [59.12873225648556, 49.01403878925586, 53.59836720205874], 'dev_rel_ign': [55.00592730358236, 49.01403878925586, 51.83740690879534], 'dev_evi': [55.686065136145224, 21.342336811950073, 30.85798816568047]}
3 {'dev_rel': [61.96585413993881, 50.95350158240688, 55.922693266832916], 'dev_rel_ign': [57.76901155186389, 50.95350158240688, 54.14763394747426], 'dev_evi': [57.550803559569665, 22.165950480867608, 32.005022713003655]}
4 {'dev_rel': [54.424115176964605, 58.89799561795017, 56.57274250750225], 'dev_rel_ign': [50.02877575431327, 58.89799561795017, 54.102303373682126], 'dev_evi': [49.247657802592975, 26.621649273582975, 34.5608500747136]}
5 {'dev_rel': [61.36003726129483, 53.45289296437555, 57.13418336369156], 'dev_rel_ign': [57.13547581157851, 53.45289296437555, 55.23286954729072], 'dev_evi': [53.14121037463977, 23.582975240433804, 32.6683910285937]}
6 {'dev_rel': [55.900197178826026, 59.81498011847764, 57.79136775255792], 'dev_rel_ign': [51.73072129847205, 59.81498011847764, 55.47989795530446], 'dev_evi': [46.69908513970164, 28.985062410476775, 35.769072945929736]}
7 {'dev_rel': [64.29532782157278, 54.27249857989126, 58.86028602860286], 'dev_rel_ign': [60.012919832027436, 54.27249857989126, 56.9985419245604], 'dev_evi': [57.0767272306446, 25.23020257826888, 34.99237291141935]}
8 {'dev_rel': [61.22520934332305, 56.366144607644245, 58.69528477268887], 'dev_rel_ign': [57.24560204369171, 56.366144607644245, 56.802469428603565], 'dev_evi': [55.182895936771715, 27.859627583384487, 37.02620933473842]}
9 {'dev_rel': [59.89958158995816, 58.08650490951879, 58.97911259424051], 'dev_rel_ign': [55.64605696441498, 58.08650490951879, 56.84009764312987], 'dev_evi': [48.958901973017234, 32.11581747493349, 38.78780389855117]}
10 {'dev_rel': [61.46569932959868, 54.313073115312825, 57.66844735481648], 'dev_rel_ign': [57.04780422044446, 54.313073115312825, 55.646859755803334], 'dev_evi': [51.23939164776069, 31.19500716185799, 38.78024738465452]}
11 {'dev_rel': [62.22242040488718, 56.617706727257975, 59.28789938817132], 'dev_rel_ign': [57.99702522756864, 56.617706727257975, 57.299066348330506], 'dev_evi': [54.90977968298275, 28.176795580110497, 37.24263835829474]}
12 {'dev_rel': [57.733595403689144, 61.97354540290514, 59.77848225118391], 'dev_rel_ign': [53.59780890231737, 61.97354540290514, 57.48217217791828], 'dev_evi': [49.362716881835375, 30.709023941068143, 37.863067267968084]}
13 {'dev_rel': [61.5350683722982, 56.60147691308934, 58.965254882069495], 'dev_rel_ign': [57.08238994282667, 56.60147691308934, 56.840916232868835], 'dev_evi': [51.58889958854942, 30.146306527522, 38.054954634981115]}
14 {'dev_rel': [62.26633434217553, 56.76377505477562, 59.38786772509233], 'dev_rel_ign': [58.02139031687326, 56.76377505477562, 57.38569331060622], 'dev_evi': [50.818980074299226, 30.79087374667485, 38.3473496432212]}
15 {'dev_rel': [61.465842773772735, 58.118964537856044, 59.745568300312826], 'dev_rel_ign': [57.33155938674185, 58.118964537856044, 57.72257679963825], 'dev_evi': [50.15702479338843, 31.046654389195826, 38.35313447927199]}
16 {'dev_rel': [62.2439277379203, 58.43544591414428, 60.279591495061105], 'dev_rel_ign': [57.92718160477058, 58.43544591414428, 58.18020372690793], 'dev_evi': [52.09214045380036, 30.888070390832823, 38.78094993416616]}
17 {'dev_rel': [63.63304093567251, 56.512212935161884, 59.86160656724117], 'dev_rel_ign': [59.42501778017635, 56.512212935161884, 57.93202473008214], 'dev_evi': [53.715046604527295, 30.954573357888275, 39.275630415733616]}
18 {'dev_rel': [62.67624135213241, 58.078390002434475, 60.28978182124506], 'dev_rel_ign': [58.378906192989355, 58.078390002434475, 58.22826035909985], 'dev_evi': [52.36622863523147, 31.18989154900757, 39.09461062485974]}
19 {'dev_rel': [63.651831288618254, 57.6807595553031, 60.51936994465732], 'dev_rel_ign': [59.41811631731843, 57.6807595553031, 58.53654964641034], 'dev_evi': [53.0990641003002, 30.765295682422757, 38.958346829047095]}
20 {'dev_rel': [63.020057808531135, 58.3867564716384, 60.614995787700074], 'dev_rel_ign': [58.785630555656354, 58.3867564716384, 58.58551459714265], 'dev_evi': [53.26741186586415, 31.69122160834868, 39.739559946115854]}
21 {'dev_rel': [62.641444242895396, 58.84930617544429, 60.68619246861924], 'dev_rel_ign': [58.37744196094944, 58.84930617544429, 58.612424388023776], 'dev_evi': [52.2826451829473, 31.87026805811336, 39.60081362827358]}
22 {'dev_rel': [64.51905626134301, 57.696989369471716, 60.9176198432078], 'dev_rel_ign': [60.36090829241595, 57.696989369471716, 58.99889381485188], 'dev_evi': [53.450833260622986, 31.338244321669734, 39.511109677835464]}
23 {'dev_rel': [64.64058234758872, 57.64829992696584, 60.944537382576236], 'dev_rel_ign': [60.492069885632304, 57.64829992696584, 59.03595855509227], 'dev_evi': [53.96481497530116, 31.854921219562105, 40.06176215138161]}
24 {'dev_rel': [63.98566950291088, 57.97289621033839, 60.831062670299715], 'dev_rel_ign': [59.74168996822018, 57.97289621033839, 58.8440040336937], 'dev_evi': [53.54784081287045, 32.35113566605279, 40.33420498756299]}
25 {'dev_rel': [64.77210323997802, 57.42919743568936, 60.88003785109037], 'dev_rel_ign': [60.54735541149307, 57.42919743568936, 58.9470694679402], 'dev_evi': [53.7715234682283, 31.471250255780642, 39.70441124269902]}
26 {'dev_rel': [65.05969197120204, 57.93232167491682, 61.289491758241766], 'dev_rel_ign': [60.83358865989009, 57.93232167491682, 59.34751844109719], 'dev_evi': [54.05966277561608, 31.982811540822592, 40.18898852569666]}
27 {'dev_rel': [64.53875202301744, 58.248803051205066, 61.232672211558956], 'dev_rel_ign': [60.30995264133043, 58.248803051205066, 59.261461254582635], 'dev_evi': [54.018085650912816, 32.39206056885615, 40.49888071634154]}
28 {'dev_rel': [65.17231972356097, 58.159539073277614, 61.46655231560892], 'dev_rel_ign': [60.96218524007524, 58.159539073277614, 59.52789241256996], 'dev_evi': [54.13507925568574, 32.14651115203601, 40.33893953010656]}
29 {'dev_rel': [65.36061662690402, 57.8024831615678, 61.349640411696306], 'dev_rel_ign': [61.17054097801837, 57.8024831615678, 59.43883818095571], 'dev_evi': [54.41432047271463, 32.033967669326785, 40.32715095311694]}
saving model checkpoint into bert_lambda0_seed66/2025-02-22_01:49:03.283087/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-02-22_01:49:03.283087/results.json ...
saving evaluations into bert_lambda0_seed66/2025-02-22_01:49:03.283087/scores.csv ...
             precision     recall         F1
dev_rel      65.172320  58.159539  61.466552
dev_rel_ign  60.962185  58.159539  59.527892
dev_evi      54.135079  32.146511  40.338940
saving topk results into bert_lambda0_seed66/2025-02-22_01:49:03.283087/topk_results.json ...
经过时间：2小时 29分钟 43秒