(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
Saving to ./feature_file/graph_True_train_annotated_feature.pkl
Save  ./feature_file/graph_True_train_annotated_feature.pkl  !!!
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Saving to ./feature_file/graph_True_dev_feature.pkl
Save  ./feature_file/graph_True_dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [56.07416879795396, 35.58386756471638, 43.538698307104205], 'dev_rel_ign': [52.28503951620359, 35.58386756471638, 42.34726443216556], 'dev_evi': [56.100408639813196, 14.748311847759362, 23.356422408555108]}0:00, 3296.69it/s]
1 {'dev_rel': [69.24857549857549, 31.558873650896697, 43.358046713863644], 'dev_rel_ign': [65.71371835276213, 31.558873650896697, 42.6399850545244], 'dev_evi': [63.41893252769386, 12.886228770206671, 21.42006802721089]}00:00, 7333.59it/s]
2 {'dev_rel': [56.18207732050596, 51.18071898076767, 53.56490721474373], 'dev_rel_ign': [51.83589537664164, 51.18071898076767, 51.50622374724855], 'dev_evi': [51.475255671799694, 22.401268671986905, 31.217251826768845]}00:00, 7208.78it/s]
3 {'dev_rel': [61.71672965983688, 50.352998458167654, 55.45872994592662], 'dev_rel_ign': [57.75899905864904, 50.352998458167654, 53.802331976949624], 'dev_evi': [57.955907021327576, 24.744219357479025, 34.68129346812935]}:00, 7452.10it/s]
4 {'dev_rel': [50.93163493461616, 60.99975655278747, 55.51288678827265], 'dev_rel_ign': [46.403197123739496, 60.99975655278747, 52.70960678314649], 'dev_evi': [49.43385805026236, 27.47084100675261, 35.3161684916642]}57<00:00, 7409.02it/s]
5 {'dev_rel': [59.48459766191655, 56.569017284752086, 57.990183844938024], 'dev_rel_ign': [55.3843262024203, 56.569017284752086, 55.97040353882856], 'dev_evi': [54.96611605252012, 26.555146306527522, 35.809878587196465]}0:00, 7371.91it/s]
6 {'dev_rel': [55.72595561035758, 58.67889312667371, 57.16431479505118], 'dev_rel_ign': [51.58843848353549, 58.67889312667371, 54.905699161166396], 'dev_evi': [50.602409638554214, 29.22038060159607, 37.047606693475146]}00:00, 7256.61it/s]
7 {'dev_rel': [57.40313653136532, 60.59401119857177, 58.955430105404446], 'dev_rel_ign': [53.2168185974191, 60.59401119857177, 56.666320908556756], 'dev_evi': [53.28175026680897, 30.647636586863108, 38.912704598597045]}00:00, 7271.69it/s]
8 {'dev_rel': [58.82112825536778, 58.46790554248153, 58.643985023604095], 'dev_rel_ign': [54.69732346443568, 58.46790554248153, 56.519797994659726], 'dev_evi': [53.67849835423895, 30.867607939431146, 39.1958166877781]}<00:00, 7221.49it/s]
9 {'dev_rel': [61.782437745740495, 57.380507993183485, 59.500168293503876], 'dev_rel_ign': [57.68598233753895, 57.380507993183485, 57.53283968425724], 'dev_evi': [57.335463896933994, 29.368733374258237, 38.84171712729611]}00, 7291.62it/s]
10 {'dev_rel': [62.05465860918192, 55.83056074007953, 58.77829987184964], 'dev_rel_ign': [57.73558362694838, 55.83056074007953, 56.76709421657794], 'dev_evi': [56.43611911623439, 30.05422549621445, 39.221576874290676]}<00:00, 7291.92it/s]
11 {'dev_rel': [58.611886717191865, 59.620222348454114, 59.11175476707701], 'dev_rel_ign': [54.31489956471037, 59.620222348454114, 56.8440413194103], 'dev_evi': [53.552254831782385, 30.616942909760592, 38.959770863168856]}00, 7345.93it/s]
12 {'dev_rel': [61.04273504273504, 57.956666396169766, 59.45968446905049], 'dev_rel_ign': [56.804397216826764, 57.956666396169766, 57.3747470733324], 'dev_evi': [55.9089198343997, 30.396971557192554, 39.382290562036054]}0:00, 7457.95it/s]
13 {'dev_rel': [64.29109395594051, 55.41670047877951, 59.524950969710176], 'dev_rel_ign': [60.06107185420546, 55.41670047877951, 57.645490766507294], 'dev_evi': [58.719221805654065, 29.64497646818089, 39.39898698031751]}0:00, 7400.35it/s]
14 {'dev_rel': [62.26398524633354, 57.53469122778544, 59.805989034162806], 'dev_rel_ign': [58.11482594978572, 57.53469122778544, 57.82330351874343], 'dev_evi': [57.071865443425075, 30.550439942705136, 39.7974143675863]}00:00, 7495.54it/s]
15 {'dev_rel': [62.929082510642154, 56.38237442181288, 59.47611710323575], 'dev_rel_ign': [58.78562072421144, 56.38237442181288, 57.558922929737044], 'dev_evi': [57.1360153256705, 30.5146306527522, 39.78257969854609]}7<00:00, 7249.93it/s]
16 {'dev_rel': [64.36160298229264, 56.04154832427169, 59.914110961696956], 'dev_rel_ign': [60.08767345779389, 56.04154832427169, 57.99412420239018], 'dev_evi': [59.030389267201954, 29.711479435236342, 39.527682308503756]}:00, 7235.57it/s]
17 {'dev_rel': [66.31745404230085, 54.45102653574616, 59.80125662849248], 'dev_rel_ign': [62.40900059297485, 54.45102653574616, 58.159051146108766], 'dev_evi': [60.07764477515367, 28.499079189686928, 38.659310919121474]}0:00, 7465.45it/s]
18 {'dev_rel': [66.10715331316483, 54.97038058914225, 60.02658396101018], 'dev_rel_ign': [62.02296330013891, 54.97038058914225, 58.28410035192451], 'dev_evi': [60.499068130047625, 29.890525885001022, 40.01232623433541]}00:00, 7237.93it/s]
19 {'dev_rel': [65.69315015851667, 55.489734642538345, 60.161886327643856], 'dev_rel_ign': [61.42795413542023, 55.489734642538345, 58.308044064775956], 'dev_evi': [59.351494206139456, 29.87006343359935, 39.74001225073164]}00, 7332.45it/s]
20 {'dev_rel': [64.06970311635625, 56.39048932889719, 59.98532521904269], 'dev_rel_ign': [59.754208344775165, 56.39048932889719, 58.02363974445225], 'dev_evi': [57.10330341798739, 30.59648045835891, 39.84411431616814]}<00:00, 7456.49it/s]
21 {'dev_rel': [65.10446075663468, 56.13892720928345, 60.29020872369165], 'dev_rel_ign': [60.8943260273209, 56.13892720928345, 58.42001382965793], 'dev_evi': [59.28970065956367, 29.890525885001022, 39.74424378464782]}7<00:00, 7388.07it/s]
22 {'dev_rel': [65.63499529633113, 56.617706727257975, 60.79379601794973], 'dev_rel_ign': [61.4459102253869, 56.617706727257975, 58.93308395126958], 'dev_evi': [59.817260899791435, 30.81133619807653, 40.67258669007664]}00:00, 7274.69it/s]
23 {'dev_rel': [66.30015432098766, 55.78187129757364, 60.58789828566392], 'dev_rel_ign': [62.16977039609163, 55.78187129757364, 58.802846336656565], 'dev_evi': [59.8304400484457, 30.32535297728668, 40.24986420423683]}8<00:00, 3701.91it/s]
24 {'dev_rel': [65.74229691876751, 57.13706078065406, 61.138366691269056], 'dev_rel_ign': [61.577128430644954, 57.13706078065406, 59.27406240508666], 'dev_evi': [59.660000000000004, 30.51974626560262, 40.38175172600514]}0:00, 7323.39it/s]
25 {'dev_rel': [66.3096490389213, 56.26876572263247, 60.87796312554873], 'dev_rel_ign': [62.1427035652883, 56.26876572263247, 59.060042904862506], 'dev_evi': [59.71791537461238, 30.540208717004298, 40.41292942968353]}8<00:00, 7296.56it/s]
26 {'dev_rel': [65.77620026153559, 57.14517568773837, 61.157670762951064], 'dev_rel_ign': [61.64154097399336, 57.14517568773837, 59.308259165927204], 'dev_evi': [59.1398893311329, 31.164313484755475, 40.818787899092094]}0:00, 7399.24it/s]
27 {'dev_rel': [66.38070727290058, 56.512212935161884, 61.05023231349171], 'dev_rel_ign': [62.249812627368286, 56.512212935161884, 59.242416078859264], 'dev_evi': [59.57655361693786, 31.092694904849598, 40.86050420168066]}00, 7347.96it/s]
28 {'dev_rel': [66.75294794362956, 56.50409802807758, 61.202425947086226], 'dev_rel_ign': [62.63333685741479, 56.50409802807758, 59.41105260522822], 'dev_evi': [59.73320158102767, 30.92387968078576, 40.75097748415802]}<00:00, 6950.56it/s]
29 {'dev_rel': [66.44103346362856, 56.55278747058347, 61.09942135718044], 'dev_rel_ign': [62.30859828428248, 56.55278747058347, 59.291331562096225], 'dev_evi': [59.47296238244514, 31.05688561489666, 40.805215754805744]}00:00, 7465.09it/s]
saving model checkpoint into bert_lambda0_seed66/2025-02-25_01:17:45.656689/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-02-25_01:17:45.656689/results.json ...
saving evaluations into bert_lambda0_seed66/2025-02-25_01:17:45.656689/scores.csv ...
             precision     recall         F1
dev_rel      66.752948  56.504098  61.202426
dev_rel_ign  62.633337  56.504098  59.411053
dev_evi      59.733202  30.923880  40.750977
saving topk results into bert_lambda0_seed66/2025-02-25_01:17:45.656689/topk_results.json ...
经过时间：2小时 47分钟 46秒
