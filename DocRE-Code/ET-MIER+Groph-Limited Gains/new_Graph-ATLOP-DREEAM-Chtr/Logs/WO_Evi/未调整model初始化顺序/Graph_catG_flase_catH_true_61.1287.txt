(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: False
cat_htrs_htrsnew: True
**********
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 129621608
trainable_num/total_num: 129.62M / 129.62M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [59.44034440344404, 31.372230787957477, 41.068677962500665], 'dev_rel_ign': [55.15130898478186, 31.372230787957477, 39.99419344777347], 'dev_evi': [57.23003449190767, 11.034376918354818, 18.50152249431745]}]
1 {'dev_rel': [71.67559668777399, 23.882171549135762, 35.82689147239637], 'dev_rel_ign': [68.18057436886299, 23.882171549135762, 35.37370425266565], 'dev_evi': [66.57963446475196, 13.044812768569674, 21.815381983061]}t/s]
2 {'dev_rel': [57.32391640866873, 48.08082447455977, 52.297100489871575], 'dev_rel_ign': [53.149229895752285, 48.08082447455977, 50.4881442467176], 'dev_evi': [52.11203975604247, 23.60343769183548, 32.49066967114992]}t/s]
3 {'dev_rel': [59.95137934679209, 46.02775298222836, 52.07491737054719], 'dev_rel_ign': [55.839160774080234, 46.02775298222836, 50.46095938457017], 'dev_evi': [54.363959443921814, 26.606302435031715, 35.72728833934398]}s]
4 {'dev_rel': [56.356752208666386, 54.3536476507344, 55.3370786516854], 'dev_rel_ign': [51.613805922002044, 54.3536476507344, 52.94830679444895], 'dev_evi': [50.32578595862518, 31.60937180274197, 38.82988751335386]}7it/s]
5 {'dev_rel': [64.31431973157268, 48.2187778949931, 55.115480938688435], 'dev_rel_ign': [60.03636356359229, 48.2187778949931, 53.48254209992219], 'dev_evi': [58.1858407079646, 26.90812359320647, 36.79865677906814]}13it/s]
6 {'dev_rel': [57.34558942106111, 57.713219183640355, 57.528816986855404], 'dev_rel_ign': [53.189983140261944, 57.713219183640355, 55.359360072986185], 'dev_evi': [50.206689214580976, 34.172293840802126, 40.66599701701518]}
7 {'dev_rel': [65.27126939498073, 50.864237604479435, 57.174131168475796], 'dev_rel_ign': [61.00783343738123, 50.864237604479435, 55.47616856994324], 'dev_evi': [56.98845265588914, 31.558215674237772, 40.62160471471372]}]
8 {'dev_rel': [61.041942604856516, 56.09835267386188, 58.465832205683355], 'dev_rel_ign': [56.774762362325106, 56.09835267386188, 56.43453077298904], 'dev_evi': [53.24355521354367, 35.394925312052386, 42.52220139507728]}]
9 {'dev_rel': [62.62950398826441, 55.43293029294814, 58.81188118811881], 'dev_rel_ign': [58.50977192741269, 55.43293029294814, 56.92980850034629], 'dev_evi': [54.99230706939833, 34.74012686719869, 42.580806972442545]}t/s]
10 {'dev_rel': [60.93189964157706, 56.56090237766777, 58.66509553067923], 'dev_rel_ign': [56.85460508123711, 56.56090237766777, 56.70737344072466], 'dev_evi': [53.33860134334255, 34.530386740331494, 41.921560103095985]}s]
11 {'dev_rel': [61.791260382809675, 55.53842408504423, 58.49822641993248], 'dev_rel_ign': [57.415979012461285, 55.53842408504423, 56.461596966687786], 'dev_evi': [54.93491514252759, 34.110906486597095, 42.087988386038]}s]
12 {'dev_rel': [60.98608486514344, 57.615840298628584, 59.25307740454829], 'dev_rel_ign': [56.65203277662528, 57.615840298628584, 57.129871856476974], 'dev_evi': [54.61969575660528, 34.898710865561696, 42.58692802297272]}
13 {'dev_rel': [63.45310312645823, 55.1732532662501, 59.02422085250456], 'dev_rel_ign': [59.33963237530928, 55.1732532662501, 57.18064910209401], 'dev_evi': [56.461945844366625, 33.814200941272766, 42.297232442809154]}/s]
14 {'dev_rel': [62.68343815513627, 55.80621601882658, 59.045247703271244], 'dev_rel_ign': [58.48712222826291, 55.80621601882658, 57.11522696683629], 'dev_evi': [55.945267168961635, 33.04685901370984, 41.550088438655735]}]
15 {'dev_rel': [63.460138332726615, 56.58524709892072, 59.82583329758483], 'dev_rel_ign': [59.2054459873954, 56.58524709892072, 57.86570062761782], 'dev_evi': [55.943647882627545, 34.33087783916513, 42.550088764899826]}s]
16 {'dev_rel': [64.79724702380952, 56.53655765641483, 60.38569880823401], 'dev_rel_ign': [60.630330704565914, 56.53655765641483, 58.511926629737744], 'dev_evi': [57.420081434635705, 33.90628197258032, 42.636132642887006]}
17 {'dev_rel': [66.6969696969697, 53.58273147772458, 59.424920127795524], 'dev_rel_ign': [62.58086475703001, 53.58273147772458, 57.73329649924334], 'dev_evi': [59.18783608381235, 32.65807243707796, 42.09138260697567]}t/s]
18 {'dev_rel': [64.55361360415682, 55.44916010711677, 59.656015365811065], 'dev_rel_ign': [60.32568461422684, 55.44916010711677, 57.78472090023935], 'dev_evi': [56.92138258217554, 34.37180274196849, 42.86169941311559]}/s]
19 {'dev_rel': [67.04119850187266, 55.197597987503045, 60.54564066046554], 'dev_rel_ign': [62.893919149030275, 55.197597987503045, 58.79496426543419], 'dev_evi': [59.72247415200436, 33.68631062001228, 43.075816052855366]}
20 {'dev_rel': [67.62604407768944, 54.532175606589306, 60.377358490566024], 'dev_rel_ign': [63.5384789033906, 54.532175606589306, 58.69183166156493], 'dev_evi': [59.57484976231052, 33.97790055248619, 43.2745870932013]}/s]
21 {'dev_rel': [65.66523605150213, 55.871135275501096, 60.37355313924938], 'dev_rel_ign': [61.47672545588365, 55.871135275501096, 58.54004364174804], 'dev_evi': [58.17377244489831, 34.97032944546757, 43.68190677018435]}s]
22 {'dev_rel': [66.94691563202659, 55.57088371338148, 60.730755587087614], 'dev_rel_ign': [62.837986301563, 55.57088371338148, 58.98143321706376], 'dev_evi': [58.98185037627268, 34.080212809494576, 43.199429368089994]}/s]
23 {'dev_rel': [66.94400939702427, 55.49784954962266, 60.685922179333595], 'dev_rel_ign': [62.79197877612166, 55.49784954962266, 58.920024491774015], 'dev_evi': [59.033211615371236, 34.73501125434827, 43.73590982286634]}]
24 {'dev_rel': [67.70279755339416, 54.791852633287355, 60.56691783279512], 'dev_rel_ign': [63.57159006608054, 54.791852633287355, 58.856098050670184], 'dev_evi': [59.37610151568558, 34.468999386126455, 43.61729673744174]}
25 {'dev_rel': [67.81334131020041, 55.18948308041873, 60.85361488904796], 'dev_rel_ign': [63.71810715553771, 55.18948308041873, 59.14793815598631], 'dev_evi': [59.9182367579097, 34.48946183752813, 43.77922077922078]}it/s]
26 {'dev_rel': [67.83614073557261, 55.2300576158403, 60.88745750581499], 'dev_rel_ign': [63.77820174679739, 55.2300576158403, 59.19713095503315], 'dev_evi': [59.7615234027407, 34.35645590341723, 43.63022152926655]}44it/s]
27 {'dev_rel': [67.70451165096678, 55.4085855716952, 60.942520528382715], 'dev_rel_ign': [63.657665628589974, 55.4085855716952, 59.247371572031824], 'dev_evi': [59.74233673922701, 34.39738080622058, 43.65808525143655]}/s]
28 {'dev_rel': [68.40938853631509, 55.108334009575586, 61.04269662921348], 'dev_rel_ign': [64.32715269670442, 55.108334009575586, 59.36195873531047], 'dev_evi': [60.240528076679624, 34.080212809494576, 43.53252523932433]}
29 {'dev_rel': [68.01909307875896, 55.50596445670697, 61.12873676214308], 'dev_rel_ign': [63.91787269839799, 55.50596445670697, 59.415661976055375], 'dev_evi': [59.871531804799716, 34.33087783916513, 43.63884644146048]}s]
dev_F1_ign: 59.415661976055375 saving model checkpoint into bert_lambda0_seed66/2025-01-08_04:11:13.341657/best.ckpt ...
saving model checkpoint into bert_lambda0_seed66/2025-01-08_04:11:13.341657/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-01-08_04:11:13.341657/results.json ...
saving evaluations into bert_lambda0_seed66/2025-01-08_04:11:13.341657/scores.csv ...
             precision     recall         F1
dev_rel      68.019093  55.505964  61.128737
dev_rel_ign  63.917873  55.505964  59.415662
dev_evi      59.871532  34.330878  43.638846
saving topk results into bert_lambda0_seed66/2025-01-08_04:11:13.341657/topk_results.json ...
经过时间：2小时 51分钟 18秒
