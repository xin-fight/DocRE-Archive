(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph

batch_epair_types - 1   61.351669

####################
**********
save_path: ./Save/use_graphTrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
**********
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/train_annotated_feature.pkl
Feature loaded from ./feature_file/train_annotated_feature.pkl
Feature file: ./feature_file/dev_feature.pkl
Feature loaded from ./feature_file/dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [45.26494670168392, 47.553355514079364, 46.3809410740433], 'dev_rel_ign': [41.46704110237317, 47.553355514079364, 44.3021379954996], 'dev_evi': [44.2615454961134, 19.807652956824228, 27.367825841108285]}
1 {'dev_rel': [55.0321855522632, 43.70688955611458, 48.72003618272275], 'dev_rel_ign': [50.909090852304416, 43.70688955611458, 47.03387317193371], 'dev_evi': [51.69930511686671, 20.933087783916513, 29.80009467283254]}
2 {'dev_rel': [57.713062895422404, 50.33676864399903, 53.773135104676875], 'dev_rel_ign': [53.38939590463604, 50.33676864399903, 51.81816336098004], 'dev_evi': [52.80361757105943, 20.907509719664414, 29.954558780416303]}
3 {'dev_rel': [58.82179095655601, 48.45411020043821, 53.13695826288156], 'dev_rel_ign': [54.86448541748787, 48.45411020043821, 51.46043278288717], 'dev_evi': [56.77891285155757, 23.0304890525885, 32.7692251701423]}
4 {'dev_rel': [56.92120227457351, 56.86115393978739, 56.89116226200625], 'dev_rel_ign': [52.6179413396909, 56.86115393978739, 54.65731799980811], 'dev_evi': [51.11851499286054, 27.47084100675261, 35.736864872059364]}
5 {'dev_rel': [61.4430875361238, 53.48535259271281, 57.18872017353579], 'dev_rel_ign': [57.08653241638667, 53.48535259271281, 55.227299676305606], 'dev_evi': [55.74212271973465, 27.51176590955596, 36.84066310453487]}
6 {'dev_rel': [54.86605115786287, 58.83307636127566, 56.78035791204918], 'dev_rel_ign': [50.551363858261034, 58.83307636127566, 54.378707685858075], 'dev_evi': [48.029556650246306, 32.918968692449354, 39.06392278273539]}
7 {'dev_rel': [61.4904617578891, 55.97662906759717, 58.60413746229981], 'dev_rel_ign': [57.134351997286814, 55.97662906759717, 56.54956572138779], 'dev_evi': [52.0526005226334, 31.588909351340288, 39.31743656680781]}
8 {'dev_rel': [58.931412779499205, 57.1046011523168, 58.003626772172765], 'dev_rel_ign': [54.62620276218894, 57.1046011523168, 55.837914199333895], 'dev_evi': [50.369276218611525, 33.14405565786781, 39.98025361759897]}
9 {'dev_rel': [60.66496163682864, 57.745678811977605, 59.169334386563], 'dev_rel_ign': [56.37704447728369, 57.745678811977605, 57.05315486561191], 'dev_evi': [51.76422093981863, 32.12093308778392, 39.642654207967674]}
10 {'dev_rel': [63.6433883898387, 53.46912277854419, 58.114305874051865], 'dev_rel_ign': [59.42653868769372, 53.46912277854419, 56.290646640065034], 'dev_evi': [55.06503370359821, 29.670554532432984, 38.562547787640035]}
11 {'dev_rel': [60.96961180396979, 56.33368497930699, 58.5600404909528], 'dev_rel_ign': [56.707257616456644, 56.33368497930699, 56.51985401483365], 'dev_evi': [49.93968636911942, 31.767955801104975, 38.83313010036583]}
12 {'dev_rel': [62.82190787087414, 56.2200762801266, 59.33792985311123], 'dev_rel_ign': [58.51881823298379, 56.2200762801266, 57.34642012792436], 'dev_evi': [52.53093363329584, 31.05688561489666, 39.03552483523549]}
13 {'dev_rel': [62.621139389548055, 56.106467580946195, 59.185071049477834], 'dev_rel_ign': [58.21605744839925, 56.106467580946195, 57.14179841777791], 'dev_evi': [56.253494874184526, 30.87783916513198, 39.870533060307814]}
14 {'dev_rel': [63.533314901852364, 55.944169439259916, 59.497712954172776], 'dev_rel_ign': [59.281745154062826, 55.944169439259916, 57.564620029427005], 'dev_evi': [56.51725431357839, 30.83179864947821, 39.898053753475445]}
15 {'dev_rel': [64.42753757654481, 56.34991479347562, 60.1186095840007], 'dev_rel_ign': [60.24471167539951, 56.34991479347562, 58.23226116809944], 'dev_evi': [57.26924211147154, 29.803560466543892, 39.204602806096695]}
16 {'dev_rel': [62.73373716091651, 57.98912602450702, 60.26819600236147], 'dev_rel_ign': [58.50439876979042, 57.98912602450702, 58.24562282307154], 'dev_evi': [55.51666812494531, 32.4585635359116, 40.96587790941666]}
17 {'dev_rel': [61.52998049359682, 58.873650896697235, 60.17251389234472], 'dev_rel_ign': [57.33634306119607, 58.873650896697235, 58.09482868231138], 'dev_evi': [55.51898959352486, 31.931655412318392, 40.54431489721023]}
18 {'dev_rel': [63.11029153494907, 58.32183721496389, 60.62165239762136], 'dev_rel_ign': [58.97060254031585, 58.32183721496389, 58.64442565949479], 'dev_evi': [55.78175895765472, 31.537753222836095, 40.294117647058826]}
19 {'dev_rel': [64.99112398392974, 56.44729367848738, 60.41865717015548], 'dev_rel_ign': [60.79723785227324, 56.44729367848738, 58.54157110922874], 'dev_evi': [58.78311093407687, 30.197462656026193, 39.898614396755654]}
20 {'dev_rel': [63.239512370025096, 57.25066947983446, 60.09625622897057], 'dev_rel_ign': [59.030968971997034, 57.25066947983446, 58.127190821964824], 'dev_evi': [56.8264648163723, 31.10804174340086, 40.20628781116731]}
21 {'dev_rel': [64.39037876693392, 56.698855798101114, 60.300336584102865], 'dev_rel_ign': [60.12383894724063, 56.698855798101114, 58.361140905522255], 'dev_evi': [57.1980039544299, 31.077348066298345, 40.273128045344556]}
22 {'dev_rel': [65.51594746716698, 56.67451107684817, 60.775355697689605], 'dev_rel_ign': [61.382498097087414, 56.67451107684817, 58.93462984823845], 'dev_evi': [58.908212560386474, 31.18989154900757, 40.78533681182687]}
23 {'dev_rel': [64.8390064397424, 57.19386513024426, 60.776958565084286], 'dev_rel_ign': [60.68305723620713, 57.19386513024426, 58.88682061903423], 'dev_evi': [58.032203707170936, 31.711684059750354, 41.012239497188226]}
24 {'dev_rel': [64.79540690786476, 57.696989369471716, 61.04052197802198], 'dev_rel_ign': [60.60575151886014, 57.696989369471716, 59.11561092930523], 'dev_evi': [57.743608743979244, 31.89073050951504, 41.08884787766939]}
25 {'dev_rel': [65.03825237349065, 57.25878438691877, 60.90108751941998], 'dev_rel_ign': [60.81206729950195, 57.25878438691877, 58.981958711922154], 'dev_evi': [58.03463925164397, 32.05443012072846, 41.29840171362662]}
26 {'dev_rel': [66.09446130500758, 56.55278747058347, 60.952464249792286], 'dev_rel_ign': [61.89917930097072, 56.55278747058347, 59.105327281944064], 'dev_evi': [59.03029148409221, 31.70145283404952, 41.25008320575119]}
27 {'dev_rel': [66.65390871686921, 56.52844274933052, 61.17502415034689], 'dev_rel_ign': [62.53896585774593, 56.52844274933052, 59.3819986921563], 'dev_evi': [59.69044414535666, 31.762840188254554, 41.46243739565943]}
28 {'dev_rel': [66.17453451194282, 57.1046011523168, 61.30591976303524], 'dev_rel_ign': [62.06096396787157, 57.1046011523168, 59.479709443566605], 'dev_evi': [59.009051040403094, 32.35113566605279, 41.7908475136296]}
29 {'dev_rel': [66.15052552552552, 57.20198003732857, 61.35166891509639], 'dev_rel_ign': [62.031578882072026, 57.20198003732857, 59.51896712728089], 'dev_evi': [58.80055788005579, 32.35113566605279, 41.738441738441736]}
dev_F1_ign: 59.51896712728089 saving model checkpoint into bert_lambda0_seed66/2025-01-07_11:41:25.936924/best.ckpt ...
saving model checkpoint into bert_lambda0_seed66/2025-01-07_11:41:25.936924/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-01-07_11:41:25.936924/results.json ...
saving evaluations into bert_lambda0_seed66/2025-01-07_11:41:25.936924/scores.csv ...
             precision     recall         F1
dev_rel      66.150526  57.201980  61.351669
dev_rel_ign  62.031579  57.201980  59.518967
dev_evi      58.800558  32.351136  41.738442
saving topk results into bert_lambda0_seed66/2025-01-07_11:41:25.936924/topk_results.json ...
经过时间：2小时 53分钟 34秒
