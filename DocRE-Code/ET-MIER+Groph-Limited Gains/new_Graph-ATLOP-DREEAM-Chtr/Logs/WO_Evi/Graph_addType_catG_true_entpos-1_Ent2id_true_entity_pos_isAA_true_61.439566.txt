(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: True
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [51.5437316487232, 47.00965673943033, 49.172396231219764], 'dev_rel_ign': [47.38164246629793, 47.00965673943033, 47.19491662544907], 'dev_evi': [49.13657770800628, 22.41661551053816, 30.787606267125696]}00, 6867.29it/s]
1 {'dev_rel': [60.95035028936948, 32.47585815142416, 42.37386838900947], 'dev_rel_ign': [58.03600645165956, 32.47585815142416, 41.646896160285706], 'dev_evi': [56.99272433306386, 18.032535297728668, 27.396727936890375]}, 6521.19it/s]
2 {'dev_rel': [56.061408152461624, 51.56211961373043, 53.717715686688926], 'dev_rel_ign': [51.49035646650073, 51.56211961373043, 51.52621305309199], 'dev_evi': [49.8380221653879, 29.905872723552278, 37.38090670758999]}0, 6841.70it/s]
3 {'dev_rel': [66.0410882842865, 48.25935243041467, 55.76706676669168], 'dev_rel_ign': [61.95571029863684, 48.25935243041467, 54.25651239212097], 'dev_evi': [60.7840800762631, 26.09474114998977, 36.51395848246242]}00:00, 6920.13it/s]
4 {'dev_rel': [59.3056643174106, 55.311206686683434, 57.238831037957674], 'dev_rel_ign': [54.737249535723166, 55.311206686683434, 55.02273137593573], 'dev_evi': [53.73367665992275, 29.890525885001022, 38.41299059890868]} 1053.36it/s]
5 {'dev_rel': [64.10737195302477, 52.71443641970299, 57.85536159600998], 'dev_rel_ign': [59.96257148837234, 52.71443641970299, 56.10537981030581], 'dev_evi': [58.03034932274163, 29.1487620216902, 38.805461913031635]}:00, 6884.28it/s]
6 {'dev_rel': [64.05622489959839, 51.773107197922585, 57.263384643001395], 'dev_rel_ign': [60.004468707402005, 51.773107197922585, 55.585706982481256], 'dev_evi': [57.91307714645243, 30.60671168405975, 40.04819438401553]}6883.70it/s]
7 {'dev_rel': [63.46083118793674, 56.00908869593443, 59.50256476572265], 'dev_rel_ign': [59.36605310903267, 56.00908869593443, 57.63873364909209], 'dev_evi': [56.92773849967864, 31.716799672600775, 40.737212129176385]}0, 6740.82it/s]
8 {'dev_rel': [58.86603196191772, 56.19573155887365, 57.499896209573635], 'dev_rel_ign': [54.63153941999668, 56.19573155887365, 55.40259715462048], 'dev_evi': [53.034670180350815, 32.944546756701456, 40.64245369347764]}, 6998.56it/s]
9 {'dev_rel': [62.05727540369346, 56.44729367848738, 59.11949685534591], 'dev_rel_ign': [57.85770901916597, 56.44729367848738, 57.143799754905686], 'dev_evi': [54.24560216508796, 32.811540822590544, 40.88996557439755]}0, 6989.12it/s]
10 {'dev_rel': [60.82047746272515, 57.26689929400308, 58.99021984452061], 'dev_rel_ign': [56.65522496505032, 57.26689929400308, 56.959420018799165], 'dev_evi': [53.78528308043726, 33.72723552281563, 41.457586618876945]}, 6930.34it/s]
11 {'dev_rel': [59.49408140100535, 59.54718818469529, 59.52062294683051], 'dev_rel_ign': [55.208893620935186, 59.54718818469529, 57.29603740711454], 'dev_evi': [53.9009900990099, 34.81174544710456, 42.30255182917353]}00, 6917.49it/s]
12 {'dev_rel': [61.741379310344826, 58.118964537856044, 59.87543368306649], 'dev_rel_ign': [57.367915410789706, 58.118964537856044, 57.740997814696094], 'dev_evi': [55.20951302378256, 34.914057704112956, 42.7765590723911]}889.75it/s]
13 {'dev_rel': [64.13123844731979, 56.30934025805404, 59.96629650434257], 'dev_rel_ign': [59.890450537525375, 56.30934025805404, 58.04471306593726], 'dev_evi': [57.15664765247915, 33.317986494782076, 42.09675855605469]}, 6867.81it/s]
14 {'dev_rel': [63.85854471394187, 55.97662906759717, 59.65837837837839], 'dev_rel_ign': [59.48526353312032, 55.97662906759717, 57.67763643536619], 'dev_evi': [58.1863091037403, 33.74258236136689, 42.71467426499157]}:00, 7060.08it/s]
15 {'dev_rel': [64.26091037071797, 55.56276880629717, 59.596135433893295], 'dev_rel_ign': [60.07130118478421, 55.56276880629717, 57.72914193681918], 'dev_evi': [58.0458208820067, 32.79107837118887, 41.90775064561472]}00, 6616.72it/s]
16 {'dev_rel': [63.08947462793617, 57.1046011523168, 59.9480342462836], 'dev_rel_ign': [58.842347236986555, 57.1046011523168, 57.96045202590668], 'dev_evi': [56.551960868445896, 33.71188868426437, 42.24223582577481]}:00, 7025.69it/s]
17 {'dev_rel': [66.20682907738968, 54.91357623955205, 60.03371185237757], 'dev_rel_ign': [62.07313049075093, 54.91357623955205, 58.27427199040166], 'dev_evi': [59.739545121056494, 33.323102107632494, 42.78208327860239]}, 6647.61it/s]
18 {'dev_rel': [62.08293818432623, 58.43544591414428, 60.20399632137781], 'dev_rel_ign': [57.86145438549253, 58.43544591414428, 58.147033662043945], 'dev_evi': [56.24948639986852, 35.01636996112134, 43.16297253838635]}0, 6859.64it/s]
19 {'dev_rel': [65.10129773130427, 56.58524709892072, 60.545280889120434], 'dev_rel_ign': [60.90367110040407, 56.58524709892072, 58.66509507902792], 'dev_evi': [58.74387527839644, 33.73235113566606, 42.855750170604104]}, 6933.09it/s]
20 {'dev_rel': [64.79874446085671, 56.95853282479916, 60.626214640466415], 'dev_rel_ign': [60.519776288548584, 56.95853282479916, 58.68517669853216], 'dev_evi': [58.38920254057869, 33.86024145692654, 42.863618702240636]} 6876.32it/s]
21 {'dev_rel': [65.70754716981132, 56.52032784224621, 60.76866029751778], 'dev_rel_ign': [61.58317473939635, 56.52032784224621, 58.9432345316072], 'dev_evi': [59.443800695249124, 34.11602209944751, 43.35164299411707]}00, 6988.42it/s]
22 {'dev_rel': [64.93686054014195, 57.16952040899132, 60.80614534783359], 'dev_rel_ign': [60.787547612836256, 57.16952040899132, 58.92304720937113], 'dev_evi': [58.68284228769497, 34.64293022304072, 43.566649511065364]}, 7016.84it/s]
23 {'dev_rel': [66.163772653952, 56.58524709892072, 61.00078733269181], 'dev_rel_ign': [62.01129214657367, 56.58524709892072, 59.174143046008666], 'dev_evi': [59.86124876114965, 33.988131778187025, 43.358240610826506]}0, 7013.98it/s]
24 {'dev_rel': [66.04147031102733, 56.86115393978739, 61.10844634369686], 'dev_rel_ign': [61.84475266139495, 56.86115393978739, 59.24834074621571], 'dev_evi': [59.40769640007093, 34.27460609781052, 43.469798222279884]}0, 6931.28it/s]
25 {'dev_rel': [66.55211912943871, 56.5771321918364, 61.16057721829904], 'dev_rel_ign': [62.508024756571764, 56.5771321918364, 59.39488799994258], 'dev_evi': [59.615899955337206, 34.14160016369961, 43.418013856812934]}0, 6870.00it/s]
26 {'dev_rel': [66.76356589147287, 55.91170981092266, 60.857660204036556], 'dev_rel_ign': [62.63616550911093, 55.91170981092266, 59.08322017851481], 'dev_evi': [59.82736917820536, 34.03928790669122, 43.39093576785132]}0, 6722.20it/s]
27 {'dev_rel': [67.65517241379311, 55.72506694798345, 61.11333600320384], 'dev_rel_ign': [63.60713882761652, 55.72506694798345, 59.4057915296385], 'dev_evi': [60.7735312986894, 33.92162881113157, 43.54049706162382]}0:00, 7013.03it/s]
28 {'dev_rel': [66.61925082977714, 57.00722226730504, 61.43956620605212], 'dev_rel_ign': [62.4933403702788, 57.00722226730504, 59.62435098350532], 'dev_evi': [60.015870216892964, 34.821976672805405, 44.07251537714471]}0, 6820.99it/s]
29 {'dev_rel': [66.66983915484916, 56.84492412561875, 61.366622864651774], 'dev_rel_ign': [62.53744109698604, 56.84492412561875, 59.55546428553091], 'dev_evi': [59.99647079583554, 34.78616738285247, 44.038598536364226]}, 6864.14it/s]
saving model checkpoint into bert_lambda0_seed66/2025-03-06_21:44:13.754930/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-03-06_21:44:13.754930/results.json ...
saving evaluations into bert_lambda0_seed66/2025-03-06_21:44:13.754930/scores.csv ...
             precision     recall         F1
dev_rel      66.619251  57.007222  61.439566
dev_rel_ign  62.493340  57.007222  59.624351
dev_evi      60.015870  34.821977  44.072515
saving topk results into bert_lambda0_seed66/2025-03-06_21:44:13.754930/topk_results.json ...
经过时间：3小时 0分钟 30秒
