(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: True
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [51.36307311028501, 47.09080581027347, 49.134244951526185], 'dev_rel_ign': [47.23955828397546, 47.09080581027347, 47.16506476093224], 'dev_evi': [48.91909962112771, 22.45754041334152, 30.783255031203982]}
1 {'dev_rel': [61.92813044166535, 31.745516513835913, 41.97424892703863], 'dev_rel_ign': [58.17391294230624, 31.745516513835913, 41.075903731911154], 'dev_evi': [57.64805414551607, 17.428892981379168, 26.765653232775556]}
2 {'dev_rel': [56.0261770587166, 50.020287267710785, 52.85316184351554], 'dev_rel_ign': [51.61516146453129, 50.020287267710785, 50.805210898942946], 'dev_evi': [51.31749860827611, 28.294454675670146, 36.476950471542565]}
3 {'dev_rel': [60.56560134566863, 46.749979712732284, 52.76849095488893], 'dev_rel_ign': [56.378648614514894, 46.749979712732284, 51.11482081573398], 'dev_evi': [54.63459011422218, 27.64988745651729, 36.717502802214604]}
4 {'dev_rel': [54.564991848228836, 59.750060861803135, 57.03993492659875], 'dev_rel_ign': [50.04888377867942, 59.750060861803135, 54.47090337039262], 'dev_evi': [49.41631172109165, 32.049314507878044, 38.88164835846832]}
5 {'dev_rel': [61.28858578607323, 55.42481538586384, 58.20940043465291], 'dev_rel_ign': [57.15988077739833, 55.42481538586384, 56.278978360809816], 'dev_evi': [54.008257354206094, 32.12093308778392, 40.283569641367805]}
6 {'dev_rel': [54.92597880814609, 59.31185587925019, 57.034724931720646], 'dev_rel_ign': [50.84412387244376, 59.31185587925019, 54.75253098791042], 'dev_evi': [48.450724429780514, 34.55596480458359, 40.340400119438634]}
7 {'dev_rel': [57.482887367766025, 59.9691633530796, 58.699710075856856], 'dev_rel_ign': [53.169979392417765, 59.9691633530796, 56.365270273195044], 'dev_evi': [51.995634549423144, 34.12113771229793, 41.20336051396096]}
8 {'dev_rel': [63.692157817827564, 53.055262517244174, 57.889144678590384], 'dev_rel_ign': [59.400871394988165, 53.055262517244174, 56.04903380501776], 'dev_evi': [56.91874119304838, 30.99549826069163, 40.13513065942437]}
9 {'dev_rel': [60.38163283087915, 56.236306094295216, 58.23529411764705], 'dev_rel_ign': [56.19460495549653, 56.236306094295216, 56.21544779132438], 'dev_evi': [54.97987047085594, 32.13627992633518, 40.563052883063214]}
11 {'dev_rel': [62.010535557506586, 57.31558873650897, 59.57069961624425], 'dev_rel_ign': [57.74826671443388, 57.31558873650897, 57.531114219649616], 'dev_evi': [54.562258443959, 33.22078985062411, 41.2972972972973]}
12 {'dev_rel': [60.35711291809876, 58.42733100705997, 59.37654626422564], 'dev_rel_ign': [56.06243607166921, 58.42733100705997, 57.22045896327303], 'dev_evi': [52.698986406851574, 34.310415387763456, 41.56158017041054]}
13 {'dev_rel': [60.74702886247878, 58.070275095350155, 59.37850060158486], 'dev_rel_ign': [56.3938136020428, 58.070275095350155, 57.21976747142201], 'dev_evi': [54.499387004495304, 34.110906486597095, 41.95953811786175]}
14 {'dev_rel': [62.38459509364284, 57.57526576320701, 59.88352464550979], 'dev_rel_ign': [58.112209871622234, 57.57526576320701, 57.842491749186486], 'dev_evi': [56.410474409114094, 33.94209126253325, 42.382625359310126]}
15 {'dev_rel': [62.058720727018525, 57.63207011279721, 59.76353767829343], 'dev_rel_ign': [57.758536766457304, 57.63207011279721, 57.69523413669645], 'dev_evi': [54.585326953748, 35.01636996112134, 42.66392420842682]}
16 {'dev_rel': [64.92608036391205, 55.59522843463442, 59.899453551912565], 'dev_rel_ign': [60.69456238243993, 55.59522843463442, 58.03309192807454], 'dev_evi': [58.12692099077924, 32.89339062819725, 42.0124142437112]}
17 {'dev_rel': [64.42263597175089, 56.99910736022073, 60.48394041160768], 'dev_rel_ign': [60.09669780876793, 56.99910736022073, 58.50693157544288], 'dev_evi': [57.63611062793529, 33.90116635972989, 42.69149004702699]}
18 {'dev_rel': [62.55479572155006, 57.899862046579564, 60.13738463483501], 'dev_rel_ign': [58.31544011485903, 57.899862046579564, 58.10690804117278], 'dev_evi': [55.740459236738936, 35.64047472887252, 43.479888913158796]}
19 {'dev_rel': [64.04766170937108, 58.01347074575997, 60.88141366829891], 'dev_rel_ign': [59.81373917503131, 58.01347074575997, 58.899851912947554], 'dev_evi': [57.15587967183227, 35.28238182934316, 43.63118772734461]}
20 {'dev_rel': [65.13018676971203, 57.44542724985799, 61.04691272852708], 'dev_rel_ign': [60.9680740875715, 57.44542724985799, 59.15435359995528], 'dev_evi': [58.29223981313263, 34.468999386126455, 43.32143890442665]}
21 {'dev_rel': [65.07168125116365, 56.72320051935406, 60.61131584652071], 'dev_rel_ign': [60.9003750928508, 56.72320051935406, 58.7376156542755], 'dev_evi': [58.84874464176363, 34.41272764477185, 43.429419929629745]}
22 {'dev_rel': [65.84463625154132, 56.33368497930699, 60.718971398583044], 'dev_rel_ign': [61.69963830918992, 56.33368497930699, 58.894689923312896], 'dev_evi': [59.20093584090704, 33.65561694290976, 42.914451583444766]}
23 {'dev_rel': [66.23204837490552, 56.88549866104034, 61.20399877766622], 'dev_rel_ign': [62.1318075205215, 56.88549866104034, 59.39302387040903], 'dev_evi': [59.79008324285198, 33.803969715571924, 43.189542483660134]}
24 {'dev_rel': [65.75904513241328, 57.22632475858151, 61.19668503492861], 'dev_rel_ign': [61.55778888027869, 57.22632475858151, 59.31308337398019], 'dev_evi': [59.21145685997171, 34.26437487210968, 43.408943616331825]}
25 {'dev_rel': [65.70232558139534, 57.31558873650897, 61.22307458934686], 'dev_rel_ign': [61.57373625682779, 57.31558873650897, 59.36840745734584], 'dev_evi': [59.040590405904055, 34.37691835481891, 43.4529582929195]}
26 {'dev_rel': [67.33658536585367, 56.00908869593443, 61.15270455854339], 'dev_rel_ign': [63.22899498821637, 56.00908869593443, 59.40045795822411], 'dev_evi': [60.62534587714444, 33.62492326580725, 43.257650542941754]}
27 {'dev_rel': [66.98449388423384, 56.439178771403064, 61.261340614815474], 'dev_rel_ign': [62.912474236814376, 56.439178771403064, 59.500279902422236], 'dev_evi': [60.11118199216258, 33.74258236136689, 43.222699125192484]}
28 {'dev_rel': [66.85538815852605, 56.53655765641483, 61.264509321139634], 'dev_rel_ign': [62.74805860359355, 56.53655765641483, 59.48058256460226], 'dev_evi': [59.99820740342386, 34.243912420708, 43.60201921511155]}
29 {'dev_rel': [66.44562334217507, 56.91795828937759, 61.31386861313869], 'dev_rel_ign': [62.32315704465147, 56.91795828937759, 59.4980488599551], 'dev_evi': [59.76399609617603, 34.45876816042562, 43.713293747363636]}
saving model checkpoint into bert_lambda0_seed66/2025-03-07_09:03:47.806734/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-03-07_09:03:47.806734/results.json ...
saving evaluations into bert_lambda0_seed66/2025-03-07_09:03:47.806734/scores.csv ...
             precision     recall         F1
dev_rel      66.984494  56.439179  61.261341
dev_rel_ign  62.912474  56.439179  59.500280
dev_evi      60.111182  33.742582  43.222699
saving topk results into bert_lambda0_seed66/2025-03-07_09:03:47.806734/topk_results.json ...
经过时间：2小时 59分钟 0秒