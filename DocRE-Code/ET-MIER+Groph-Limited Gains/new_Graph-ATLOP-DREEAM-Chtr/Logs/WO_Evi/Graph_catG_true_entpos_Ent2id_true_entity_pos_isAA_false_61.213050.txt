(DREEAM) root@autodl-container-9cb9118e00-cf383cf7:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: False
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
Feature file: ./feature_file/graph_True_train_annotated_feature.pkl
Feature loaded from ./feature_file/graph_True_train_annotated_feature.pkl
Feature file: ./feature_file/graph_True_dev_feature.pkl
Feature loaded from ./feature_file/graph_True_dev_feature.pkl
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [50.18640665328362, 42.6032621926479, 46.08497191011236], 'dev_rel_ign': [46.3668175726978, 42.6032621926479, 44.405438127026116], 'dev_evi': [45.46151319391218, 21.240024554941684, 28.95296537777623]}:00<00:00, 7358.02it/s]
1 {'dev_rel': [56.48399348887683, 42.23809137385377, 48.333178568112174], 'dev_rel_ign': [53.00597673384979, 42.23809137385377, 47.01334861322727], 'dev_evi': [51.21804872194888, 21.833435645590342, 30.615831569886303]}00:00, 7237.49it/s]
2 {'dev_rel': [54.35394456289979, 51.71630284833238, 53.00232867598137], 'dev_rel_ign': [50.03267664080602, 51.71630284833238, 50.860560380260566], 'dev_evi': [46.85338865836791, 27.726621649273582, 34.83738269700475]}<00:00, 7424.94it/s]
3 {'dev_rel': [66.22199848980618, 42.70064107765966, 51.92165375696878], 'dev_rel_ign': [62.43001111082026, 42.70064107765966, 50.71406752310733], 'dev_evi': [59.66241360978203, 22.963986085533048, 33.16341607565011]}7<00:00, 7369.98it/s]
4 {'dev_rel': [48.74705371541992, 63.77505477562282, 55.25751450166989], 'dev_rel_ign': [44.39434721104014, 63.77505477562282, 52.348480681462775], 'dev_evi': [44.11727051593906, 35.256803765091064, 39.19249360250214]}<00:00, 7444.78it/s]
5 {'dev_rel': [61.93364580461355, 54.68635884119127, 58.0848129632822], 'dev_rel_ign': [57.578861063520215, 54.68635884119127, 56.095347436354444], 'dev_evi': [56.05587208233781, 31.205238387558833, 40.092014459415054]}00:00, 7486.80it/s]
6 {'dev_rel': [58.87116974200551, 57.21820985149721, 58.03292181069959], 'dev_rel_ign': [54.73674533241134, 57.21820985149721, 55.94997695051609], 'dev_evi': [51.55723559865232, 32.095355023531816, 39.56237979632375]}7<00:00, 7264.21it/s]
7 {'dev_rel': [62.91929439722146, 55.863020368416784, 59.181568088032996], 'dev_rel_ign': [58.82054399226499, 55.863020368416784, 57.303647047227514], 'dev_evi': [56.222146040452515, 33.55842029875179, 42.029728344438745]}00, 7375.26it/s]
8 {'dev_rel': [60.4496463455709, 58.25691795828938, 59.33303029050786], 'dev_rel_ign': [56.26222175597149, 58.25691795828938, 57.24219803199505], 'dev_evi': [54.40776038121171, 32.70922856558215, 40.856230031948876]}57<00:00, 7287.02it/s]
9 {'dev_rel': [61.905629440699585, 55.148908544997155, 58.332260418007806], 'dev_rel_ign': [57.85973391993174, 55.148908544997155, 56.471807904045036], 'dev_evi': [55.56853932584269, 31.624718641293224, 40.30906660580967]}00, 7379.01it/s]
10 {'dev_rel': [57.34830423748366, 60.51286212772864, 58.888099186606645], 'dev_rel_ign': [53.12711286922996, 60.51286212772864, 56.579978240685676], 'dev_evi': [53.1237933431153, 35.19030079803561, 42.33621565067545]}<00:00, 7425.64it/s]
11 {'dev_rel': [62.26018396846255, 57.67264464821877, 59.87867554132613], 'dev_rel_ign': [58.166634241438494, 57.67264464821877, 57.918586150468784], 'dev_evi': [56.14165428429916, 34.791282995702886, 42.96001516012886]}0:00, 7516.60it/s]
12 {'dev_rel': [60.47227072420387, 59.01971922421488, 59.73716632443531], 'dev_rel_ign': [56.31719189900102, 59.01971922421488, 57.63679330417275], 'dev_evi': [54.98024034196306, 34.873132801309595, 42.67693367139324]}<00:00, 7483.98it/s]
13 {'dev_rel': [61.763444549275235, 58.43544591414428, 60.053373363355846], 'dev_rel_ign': [57.603423625674345, 58.43544591414428, 58.01645188541872], 'dev_evi': [54.853108261645836, 34.576427255985266, 42.41606526513962]}00, 7463.16it/s]
14 {'dev_rel': [63.66028491062517, 56.93418810354621, 60.10966415352982], 'dev_rel_ign': [59.32358312073575, 56.93418810354621, 58.104331517872495], 'dev_evi': [57.46268656716418, 33.4816861059955, 42.31042730622536]}7<00:00, 7227.53it/s]
15 {'dev_rel': [62.793815354365904, 57.01533717438936, 59.76522626743791], 'dev_rel_ign': [58.411588353235175, 57.01533717438936, 57.705017951886816], 'dev_evi': [56.4476680441933, 34.23879680785758, 42.62378602133418]}00:00, 7430.90it/s]
16 {'dev_rel': [68.46875, 53.33928426519516, 59.964420927792716], 'dev_rel_ign': [64.42590191041732, 53.33928426519516, 58.360736438982784], 'dev_evi': [61.630935684231616, 31.471250255780642, 41.66610226887911]}[00:57<00:00, 7423.01it/s]
17 {'dev_rel': [65.28382168068852, 54.78373772620303, 59.57465584186375], 'dev_rel_ign': [61.17239880902834, 54.78373772620303, 57.80207503581805], 'dev_evi': [59.14651227939116, 32.40229179455699, 41.86799748818455]}3<00:00, 7472.63it/s]
18 {'dev_rel': [65.32057416267942, 55.39235575752658, 59.94818425328239], 'dev_rel_ign': [61.15339258103399, 55.39235575752658, 58.13048568340694], 'dev_evi': [58.80733944954129, 32.79107837118887, 42.10457172884919]}8<00:00, 6298.13it/s]
19 {'dev_rel': [64.82861400894187, 56.479753306824634, 60.366884947309075], 'dev_rel_ign': [60.62154545768949, 56.479753306824634, 58.477403216749266], 'dev_evi': [58.737164474869395, 33.35891139758543, 42.55138662316477]}00, 7466.17it/s]
20 {'dev_rel': [65.66247993200491, 56.42294895723444, 60.693086592178766], 'dev_rel_ign': [61.560418583824486, 56.42294895723444, 58.87983074109737], 'dev_evi': [59.81444424231399, 33.6402701043585, 43.062012965752075]}00:00, 7387.85it/s]
21 {'dev_rel': [65.16581036898646, 56.609591820173655, 60.587111342713214], 'dev_rel_ign': [61.010037577362986, 56.609591820173655, 58.72749883465129], 'dev_evi': [59.02853015529072, 33.44587681604256, 42.69853709508882]}:00, 7440.08it/s]
22 {'dev_rel': [66.5820808120242, 55.35989612918932, 60.45460587531571], 'dev_rel_ign': [62.53829314820756, 55.35989612918932, 58.73056124103358], 'dev_evi': [60.240514589353964, 33.057090239410684, 42.68868703550785]}<00:00, 7444.82it/s]
23 {'dev_rel': [66.38347171268585, 55.79810111174227, 60.63224725541202], 'dev_rel_ign': [62.299696771005095, 55.79810111174227, 58.869933935783514], 'dev_evi': [60.01669449081803, 33.103130755064456, 42.6706231454006]}00:00, 7217.62it/s]
24 {'dev_rel': [67.00432730133753, 55.286861965430504, 60.58423369347739], 'dev_rel_ign': [62.98135268345874, 55.286861965430504, 58.88380682068887], 'dev_evi': [60.62142119590725, 33.03662778800901, 42.76679580146353]}00:00, 7355.36it/s]
25 {'dev_rel': [66.75413022351798, 55.74129676215207, 60.75266439658604], 'dev_rel_ign': [62.665065958021316, 55.74129676215207, 59.00074891145655], 'dev_evi': [60.22277455583173, 33.46633926744424, 43.02390582355069]}<00:00, 7462.41it/s]
26 {'dev_rel': [66.0570453899365, 56.569017284752086, 60.94596957510055], 'dev_rel_ign': [61.90982554029155, 56.569017284752086, 59.119044507488404], 'dev_evi': [59.90125673249551, 34.1364845508492, 43.48931178310741]}<00:00, 7524.90it/s]
27 {'dev_rel': [66.4859208523592, 56.715085612269746, 61.21305014232538], 'dev_rel_ign': [62.42934833909636, 56.715085612269746, 59.435186661180374], 'dev_evi': [60.34668582719598, 34.37180274196849, 43.7976663841992]}<00:00, 7403.85it/s]
28 {'dev_rel': [66.56468113586385, 56.495983120993266, 61.11842682819769], 'dev_rel_ign': [62.482566181222445, 56.495983120993266, 59.3386627259028], 'dev_evi': [60.044903457566235, 34.202987517904646, 43.58113613401557]}:00, 7476.10it/s]
29 {'dev_rel': [66.9041887337506, 56.38237442181288, 61.1942927602607], 'dev_rel_ign': [62.82314757942331, 56.38237442181288, 59.42876084453738], 'dev_evi': [60.34124763022479, 34.19275629220381, 43.650612244897964]}58<00:00, 7465.91it/s]
saving model checkpoint into bert_lambda0_seed66/2025-03-02_19:49:39.474664/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-03-02_19:49:39.474664/results.json ...
saving evaluations into bert_lambda0_seed66/2025-03-02_19:49:39.474664/scores.csv ...
             precision     recall         F1
dev_rel      66.485921  56.715086  61.213050
dev_rel_ign  62.429348  56.715086  59.435187
dev_evi      60.346686  34.371803  43.797666
saving topk results into bert_lambda0_seed66/2025-03-02_19:49:39.474664/topk_results.json ...
经过时间：2小时 48分钟 13秒
