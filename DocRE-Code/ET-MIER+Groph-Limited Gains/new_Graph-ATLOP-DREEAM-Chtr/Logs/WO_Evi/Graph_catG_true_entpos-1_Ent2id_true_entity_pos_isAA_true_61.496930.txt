(DREEAM) root@autodl-container-8ee54ba345-ce12d4e2:~/autodl-tmp/new_Graph-ATLOP-DREEAM-Chtr# python run_iscf_SAIS_Evidence.py --do_train --data_dir dataset/docred --transformer_type bert --model_name_or_path bert-base-cased --display_name bert_lambda0_seed66 --save_path bert_lambda0_seed66 --train_file train_annotated.json --dev_file dev.json --train_batch_size 4 --test_batch_size 8 --gradient_accumulation_steps 1 --num_labels 4 --lr_transformer 5e-5 --max_grad_norm 1.0 --evi_thresh 0.2 --evi_lambda 0 --warmup_ratio 0.06 --num_train_epochs 30.0 --num_class 97 --loss_weight_ET 0.25 --TSER_Logsumexp --three_atten --use_graph
####################
**********
save_path: ./Save/use_graphTrue_docred_ent2id_NATrue_REDocred_TASK_ETTrue0.25_0.0_s_attn_lambda0_threeTrue_clsFalse_relation768_extractor768_seed66_Relation_SeplossTrue_Crht_lossFalse_Emb_lossFalse_Relation_lossTrue
全微调: True
seed: 66
&&&&&&&&&&
&&&&&&&&&&
use_graph: True
cat_graph: True
cat_htrs_htrsnew: False
entity_pos_isAA: True
**********
**********
docred_ent2id_NA: True
IS_high_batch_ET_loss: True
**********
three_atten: True
use_cls_info: False
use_bilinear: True
&&&&&&&&&&
reduced_dim: 768
relation_dim: 768
extractor_dim: 768
*&*&*&*&*&*&*&*&*&*&
Relation_Specific_num: 6
Crht_loss: False
__Crht_loss: 0.01
**Crht_MY_logsumexploss: True
Emb_loss: False
__Emb_loss: 0.01
**Emb_MY_logsumexploss: True
Relation_loss: True
__Relation_Seploss: True
*$*$*$*$*$*$*$*$*$*$
PEMSCLloss: False
evi_loss: True
attn_loss: True
&&&&&&&&&&
TASK_ET: True
**loss_weight_ET: 0.25
&&&&&&&&&&
frozen_relation_vector: False
&&&&&&&&&&
enhance_evi: []
s_attn_lambda: 0
&&&&&&&&&&
TSER_Logsumexp: True
TSER_Logsumexp_new_mean: False
____________________
one_mention_copy_or_addrel: False
####################
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
total parameters: 130801256
trainable_num/total_num: 130.80M / 130.80M
# of documents 3053.
# of positive examples 35615.
# of negative examples 1163035.
Saving to ./feature_file/graph_True_train_annotated_feature.pkl
Save  ./feature_file/graph_True_train_annotated_feature.pkl  !!!
# of documents 1000.
# of positive examples 11518.
# of negative examples 385272.
Saving to ./feature_file/graph_True_dev_feature.pkl
Save  ./feature_file/graph_True_dev_feature.pkl  !!!
Total steps: 22890
Warmup steps: 1373
0 {'dev_rel': [57.46234067207416, 40.24182423111255, 47.334510571278585], 'dev_rel_ign': [53.39004564069319, 40.24182423111255, 45.892767821585686], 'dev_evi': [54.8641021832764, 18.89707386944956, 28.111563486929718]}<00:00, 6830.21it/s]
1 {'dev_rel': [61.742962752345754, 35.2430414671752, 44.87265588675932], 'dev_rel_ign': [59.19017279467672, 35.2430414671752, 44.180254385236], 'dev_evi': [57.57211538461539, 17.152649887456516, 26.43071102002207]}0:58<00:00, 7039.71it/s]
2 {'dev_rel': [56.59875996457041, 51.85425626876572, 54.12272900520899], 'dev_rel_ign': [52.23706009139579, 51.85425626876572, 52.04495428482924], 'dev_evi': [50.533152384645206, 26.667689789236746, 34.911599249933026]}00:00, 7189.06it/s]
3 {'dev_rel': [63.72362869198312, 49.022153696340176, 55.41439251479156], 'dev_rel_ign': [59.94642434201442, 49.022153696340176, 53.93670139672555], 'dev_evi': [53.515625, 27.33271945979128, 36.18447785453068]}0 [00:58<00:00, 7228.75it/s]
4 {'dev_rel': [51.04313409807473, 61.746328004544345, 55.88688946015423], 'dev_rel_ign': [46.741589398860405, 61.746328004544345, 53.206321580382564], 'dev_evi': [42.215440952090326, 35.384694086351544, 38.49942949378009]}00, 7118.10it/s]
5 {'dev_rel': [59.84040168564512, 54.15888988071087, 56.85806781393764], 'dev_rel_ign': [55.70171095272306, 54.15888988071087, 54.91946715692143], 'dev_evi': [49.417098445595855, 31.225700838960506, 38.26959247648903]}<00:00, 7257.89it/s]
6 {'dev_rel': [56.173273907264054, 58.29749249371095, 57.21567378145907], 'dev_rel_ign': [52.02430878025823, 58.29749249371095, 54.98254589001576], 'dev_evi': [46.067883667661555, 33.95232248823409, 39.092917096156675]}00:00, 7341.39it/s]
7 {'dev_rel': [59.1089436270458, 58.029700559928585, 58.56435035420334], 'dev_rel_ign': [54.85490047923444, 58.029700559928585, 56.39765600890606], 'dev_evi': [49.9429874572406, 33.60957642725598, 40.179800018346945]}9<00:00, 7218.25it/s]
8 {'dev_rel': [63.20624712907671, 55.83056074007953, 59.28990003447087], 'dev_rel_ign': [59.11179167012579, 55.83056074007953, 57.42434196084659], 'dev_evi': [54.90196078431373, 33.51749539594843, 41.62378502001143]}:00<00:01, 471.91it/s]
9 {'dev_rel': [62.040779664061795, 56.04966323135601, 58.893246930422926], 'dev_rel_ign': [57.71039722034384, 56.04966323135601, 56.867908056737015], 'dev_evi': [53.27210103329506, 33.23102107632494, 40.929998109759936]}0:00, 7142.11it/s]
10 {'dev_rel': [59.66883500887049, 57.31558873650897, 58.46854304635761], 'dev_rel_ign': [55.61134350942692, 57.31558873650897, 56.45060625094155], 'dev_evi': [49.73794936148225, 34.468999386126455, 40.71914186432996]}<00:00, 7034.40it/s]
11 {'dev_rel': [60.5972943078363, 57.79436825448349, 59.16265160325636], 'dev_rel_ign': [56.340152676213684, 57.79436825448349, 57.05799620887807], 'dev_evi': [50.89754007534905, 35.24657253939022, 41.650294695481335]}<00:00, 3810.79it/s]
12 {'dev_rel': [62.29250393150445, 57.859287511157994, 59.99410997517774], 'dev_rel_ign': [58.17018796455691, 57.859287511157994, 58.0143212096799], 'dev_evi': [53.018882586059526, 34.903826478412114, 42.09519696455564]}0:00, 7194.15it/s]
13 {'dev_rel': [60.936055793630786, 58.84930617544429, 59.87450462351387], 'dev_rel_ign': [56.54734082012586, 58.84930617544429, 57.675363365774956], 'dev_evi': [51.495588551753826, 36.72498465316145, 42.87377944996864]}0:00, 7224.19it/s]
14 {'dev_rel': [61.664253470743546, 58.751927290432526, 60.172872340425535], 'dev_rel_ign': [57.48961082594484, 58.751927290432526, 58.113915041619656], 'dev_evi': [52.55924522695194, 36.19296091671782, 42.86709685237359]}00, 7162.04it/s]
15 {'dev_rel': [61.957366013635976, 58.25691795828938, 60.05018820577164], 'dev_rel_ign': [57.81414483891842, 58.25691795828938, 58.03468688132926], 'dev_evi': [52.18345568758041, 35.27215060364232, 42.09273221208144]}<00:00, 7241.68it/s]
16 {'dev_rel': [64.84775118726138, 56.512212935161884, 60.39372127308993], 'dev_rel_ign': [60.615545059347376, 56.512212935161884, 58.49200306105613], 'dev_evi': [54.804446274186915, 34.04951913239206, 42.0029659546272]}0:00, 7142.91it/s]
17 {'dev_rel': [66.12406087459064, 55.70883713381482, 60.471261836599865], 'dev_rel_ign': [62.01533636244159, 55.70883713381482, 58.693166757698464], 'dev_evi': [56.13843044796227, 34.10579087374668, 42.432535641547865]}0:00, 7141.62it/s]
18 {'dev_rel': [64.44177004258471, 56.48786821390895, 60.20324324324324], 'dev_rel_ign': [60.299741539741866, 56.48786821390895, 58.33159631599072], 'dev_evi': [53.84615384615385, 34.37691835481891, 41.96328212813788]}<00:00, 7002.97it/s]
19 {'dev_rel': [63.03707553707554, 59.05217885255214, 60.97959525704948], 'dev_rel_ign': [58.840551693990015, 59.05217885255214, 58.946175329183625], 'dev_evi': [53.33383560611769, 36.2134233681195, 43.13701593491972]}<00:00, 7243.77it/s]
20 {'dev_rel': [64.71789161098738, 56.59336200600503, 60.383566388155316], 'dev_rel_ign': [60.51100949261424, 56.59336200600503, 58.4866546268036], 'dev_evi': [54.89227280090717, 34.668508287292816, 42.49702138333228]}<00:00, 6881.41it/s]
21 {'dev_rel': [66.75169233787894, 55.21382780167167, 60.437022561733876], 'dev_rel_ign': [62.69675282036681, 55.21382780167167, 58.71784695971007], 'dev_evi': [56.730440724291086, 33.97790055248619, 42.50063987714359]}00:00, 7174.45it/s]
22 {'dev_rel': [65.14139288002197, 57.76190862614623, 61.23010752688172], 'dev_rel_ign': [60.94935404864737, 57.76190862614623, 59.312839237925765], 'dev_evi': [54.88317757009346, 36.049723756906076, 43.51611708040014]}00:00, 6915.16it/s]
23 {'dev_rel': [66.27465857359635, 56.70697070518542, 61.118642585385054], 'dev_rel_ign': [62.09763370059941, 56.70697070518542, 59.28000371254573], 'dev_evi': [55.26337082288211, 34.93963576836505, 42.81192214874479]}<00:00, 6819.88it/s]
24 {'dev_rel': [64.66328747284577, 57.97289621033839, 61.135595396003595], 'dev_rel_ign': [60.39764652018904, 57.97289621033839, 59.160436579811616], 'dev_evi': [54.14589245992176, 36.11111111111111, 43.32668405708148]}00:00, 7258.16it/s]
25 {'dev_rel': [65.57937534651636, 57.59149557737564, 61.32642039317348], 'dev_rel_ign': [61.39496314499434, 57.59149557737564, 59.43243939527936], 'dev_evi': [55.13226675114843, 35.60978105177, 43.27096413252937]}0:59<00:00, 7271.84it/s]
26 {'dev_rel': [66.80712507182533, 56.609591820173655, 61.287063474632106], 'dev_rel_ign': [62.66695383168144, 56.609591820173655, 59.484463733209715], 'dev_evi': [55.90724165988609, 35.14937589523225, 43.16225893586281]}:00, 6930.89it/s]
27 {'dev_rel': [66.7111280487805, 56.82057940436582, 61.36991103904641], 'dev_rel_ign': [62.61902207914943, 56.82057940436582, 59.579052041012034], 'dev_evi': [56.12401845705497, 35.46654389195826, 43.46572207767782]}9<00:00, 7188.07it/s]
28 {'dev_rel': [66.58745247148289, 56.84492412561875, 61.33169898874928], 'dev_rel_ign': [62.42650982102992, 56.84492412561875, 59.50511529510039], 'dev_evi': [56.03469043603951, 35.69674647022713, 43.611137151964]}:02<00:00, 7086.28it/s]
29 {'dev_rel': [66.34723788049605, 57.30747382942465, 61.496930378368965], 'dev_rel_ign': [62.163304043347104, 57.30747382942465, 59.63670753710867], 'dev_evi': [55.71121547401099, 35.80417434008594, 43.592538382485756]}0:00, 6846.42it/s]
dev_F1_ign: 59.63670753710867 saving model checkpoint into bert_lambda0_seed66/2025-02-26_04:46:19.848760/best.ckpt ...
saving model checkpoint into bert_lambda0_seed66/2025-02-26_04:46:19.848760/last.ckpt ...
saving official predictions into bert_lambda0_seed66/2025-02-26_04:46:19.848760/results.json ...
saving evaluations into bert_lambda0_seed66/2025-02-26_04:46:19.848760/scores.csv ...
             precision     recall         F1
dev_rel      66.347238  57.307474  61.496930
dev_rel_ign  62.163304  57.307474  59.636708
dev_evi      55.711215  35.804174  43.592538
saving topk results into bert_lambda0_seed66/2025-02-26_04:46:19.848760/topk_results.json ...
经过时间：3小时 3分钟 14秒
